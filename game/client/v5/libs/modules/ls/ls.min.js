var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){var n=e.call(this)||this;return n._sid=0,t.UID++,n._sid=t.UID,n}return __extends(t,e),Object.defineProperty(t.prototype,"sid",{get:function(){return this._sid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return egret.getQualifiedClassName(this)},enumerable:!0,configurable:!0}),t.prototype.getClass=function(){return this.constructor},t.prototype.clone=function(){var e=this.getClass();return new e},t}(egret.EventDispatcher);t.UID=0,e.BaseClass=t,__reflect(t.prototype,"ls.BaseClass")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(t){function n(){var e=t.apply(this,arguments)||this;return e.currentKeys={},e}return __extends(n,t),n.prototype.getStatus=function(t){return e.eval_e(this[t])===this.currentKeys[t]},n}(e.BaseClass);e.BaseEvent=t,__reflect(t.prototype,"ls.BaseEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(t){function n(){var r=t.call(this)||this;return r.id=0,r.name="Object",r.isModel=!1,r.timeScale=-1,r.parallaxX=100,r.parallaxY=100,r.isDead=!1,r.global=!1,r.variables={},r.index=0,r.paramInstances={},r.actionSaves={},r.currentStatus=!0,r.selfStatus=!0,r._uid=0,n._uniqueID++,n.U_ID++,r._uid=n.U_ID,r.name="Object",r.plugin=egret.getQualifiedClassName(r),e.Trigger.register(r),r}return __extends(n,t),Object.defineProperty(n.prototype,"u_id",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dt",{get:function(){return 1/60},enumerable:!0,configurable:!0}),n.prototype.getClass=function(){return this.constructor},n.prototype.initialize=function(){},n.prototype.onCreate=function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCreated))},n.prototype.onTick=function(){},n.prototype.addVariable=function(t,n){this[t]=e.eval_e(n),this.variables[t]=e.eval_e(n)},n.prototype.getFirstPicked=function(){var t=e.World.getInstance().objectHash[this.name];return t?t[0]:void 0},n.prototype.onCreated=function(e){return{instances:[this],status:!0}},n.prototype.compareInstanceVariable=function(t){return{instances:[this],status:e.compare(this[t.instanceVariable],t.operationType,t.value)}},n.prototype.compareTwoValue=function(t){return{instances:[this],status:e.compare(t.value1,t.operationType,t.value2)}},n.prototype.isBetweenValues=function(t){var n=e.eval_e(t.value),r=e.eval_e(t.lowerValue),a=e.eval_e(t.highValue);return a>r?{instances:[this],status:n>r&&a>n}:{instances:[this],status:r>n&&n>a}},n.prototype.isNumberNaN=function(t){return{instances:[this],status:"number"==typeof e.eval_e(t.value)}},n.prototype.addTo=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject addTo parameter type incorrect!!"),this[t]+=r,this.variables[t]=this[t]},n.prototype.setBoolean=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject setBoolean parameter type incorrect!!"),this[t]=1==r,this.variables[t]=this[t]},n.prototype.setValue=function(t,n){var r=e.eval_e(n);this[t]=r,this.variables[t]=this[t]},n.prototype.subtractFrom=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=r,this.variables[t]=this[t]},n.prototype.toogleBoolean=function(e){this[e]=!this[e],this.variables[e]=this[e]},n.prototype.destoryOnChangeScene=function(){this.destory()},n.prototype.destory=function(){},n.prototype.saveToJSON=function(){return{plugin:egret.getQualifiedClassName(this),id:this.id,uid:this.u_id,name:this.name,isModel:this.isModel,isDead:this.isDead,paramInstances:this.paramInstances,timeScale:this.timeScale,global:this.global,variables:JSON.stringify(this.variables)}},n.prototype.loadFromJSON=function(e){if(e){this.plugin=e.plugin,this.id=e.id,this._uid=e.uid,this.name=e.name,this.isModel=e.isModel,this.isDead=e.isDead,this.paramInstances=e.paramInstances,this.timeScale=e.timeScale,this.global=e.global,this.variables=JSON.parse(e.variables);for(var t in this.variables)this.addVariable(t,this.variables[t])}},n.prototype.clone=function(){var e=this.getClass(),t=new e;t.id=-Number.MAX_VALUE,t.name=this.name,t.isModel=!1,t.timeScale=this.timeScale,t.global=this.global;for(var n in this.variables)t.addVariable(n,this.variables[n]);return t},n}(egret.EventDispatcher);t._uniqueID=0,t.U_ID=0,e.AIObject=t,__reflect(t.prototype,"ls.AIObject");var n=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareTwoValuesEvent=n,__reflect(n.prototype,"ls.CompareTwoValuesEvent");var r=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsBetweenValuesEvent=r,__reflect(r.prototype,"ls.IsBetweenValuesEvent");var a=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsNumberNaNEvent=a,__reflect(a.prototype,"ls.IsNumberNaNEvent");var i=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnCreatedEvent=i,__reflect(i.prototype,"ls.OnCreatedEvent");var s=function(e){function t(){var t=e.apply(this,arguments)||this;return t.value=0,t}return __extends(t,e),t}(e.BaseEvent);e.CompareInstanceVariableEvent=s,__reflect(s.prototype,"ls.CompareInstanceVariableEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._isAddToStage=!1,e._collision=!1,e._isCollisioning=!1,e._mirrored=3,e._sourceWidth=0,e._sourceHeight=0,e._x=0,e._y=0,e._anchorX=0,e._anchorY=0,e._anchorOffsetX=0,e._anchorOffsetY=0,e._width=1,e._height=1,e._scaleX=1,e._scaleY=1,e._scale=1,e._angle=0,e._alpha=1,e._visible=!0,e.behaviors=[],e.layer=0,e.vx=0,e.vy=0,e.snapPixelsEnabled=!1,e.isInScreenOnce=!1,e.solidEnabeld=!1,e.platformEnabled=!1,e.jumpthruEnabled=!1,e.collisionType=-1,e.collisionIsRect=!0,e.scaleContainer=!0,e.update=!0,e._updateX=!0,e._updateY=!0,e._updateWidth=!0,e._updateHeight=!0,e._updateAngle=!0,e._updateAnchorOffsetX=!0,e._updateAnchorOffsetY=!0,e._updateScaleX=!0,e._updateScaleY=!0,e.isOldCollision=!1,e._scaleXChanged=!1,e._scaleYChanged=!1,e.onTweenStatus={},e._container=new egret.Sprite,e._container.owner=e,e._container.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStageHanlder,e),e._container.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemoveToStageHanlder,e),e._container.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouchEvent,e),e._container.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchEvent,e),e._container.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEvent,e),e._container.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchEvent,e),e._container.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.onTouchEvent,e),e}return __extends(n,t),n.prototype.onTouchEvent=function(t){switch(this._isTouchDown=t.touchDown,this._touchPointID=t.touchPointID,this._touchX=t.localX,this._touchY=t.localY,this._touchStageX=t.stageX,this._touchStageY=t.stageY,t.type){case egret.TouchEvent.TOUCH_TAP:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonTap));break;case egret.TouchEvent.TOUCH_BEGIN:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonBegin));break;case egret.TouchEvent.TOUCH_END:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonEnd));break;case egret.TouchEvent.TOUCH_MOVE:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonMove));break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonReleaseOutside))}},Object.defineProperty(n.prototype,"sortIndex",{get:function(){var t=e.World.getInstance().objectHash[this.name];return t?t.indexOf(this):0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"count",{get:function(){return e.World.getInstance().objectHash[this.name].length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"layerIndex",{get:function(){return e.LayerManager.getIndexByLayer(this.container.parent)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enabled",{get:function(){return this.container.touchEnabled},set:function(e){this.container.touchChildren=this.container.touchEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"collision",{get:function(){return this._collision},set:function(e){this._collision=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCollsioning",{get:function(){return this._isCollisioning},set:function(e){this._isCollisioning=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isOnScreen",{get:function(){return this.container.stage?(this.renderUpdate(),this._boundRect=this._boundRect?this._boundRect:new egret.Rectangle,this.container.getTransformedBounds(e.GameUILayer.stage,this._boundRect),void 0===this._stageRect?this._stageRect=new egret.Rectangle(0,0,e.GameUILayer.stage.stageWidth,e.GameUILayer.stage.stageHeight):(this._stageRect.width=e.GameUILayer.stage.stageWidth,this._stageRect.height=e.GameUILayer.stage.stageHeight),this._boundRect.intersects(this._stageRect)):!1},enumerable:!0,configurable:!0}),n.prototype.getBounds=function(){return this.container.stage&&(this.renderUpdate(),this._boundRect=this._boundRect?this._boundRect:new egret.Rectangle,this.container.getBounds(this._boundRect)),this._boundRect},n.prototype.intersects=function(e){var t=this.getGlobalBounds(),n=e.getGlobalBounds();return t.intersects(n)},n.prototype.intersects_rect_off=function(e,t,n){var r=this.getBounds(),a=e.getBounds();return a=a.clone(),a.offset(t,n),r.intersects(a)},n.prototype.getGlobalBounds=function(){return this.container.stage&&(this.renderUpdate(),this._boundRect=this._boundRect?this._boundRect:new egret.Rectangle,this.container.getTransformedBounds(e.GameUILayer.stage,this._boundRect)),this._boundRect},n.prototype.getCacheCollisionPolygonData=function(){for(var t=[],n=0;n<this.collisionVectorData.length;n++){for(var r=[],a=0;a<this.collisionVectorData[n].length;a++){var i=this.collisionVectorData[n][a],s=new egret.Matrix;s.translate(i.x-this.anchorOffsetX,i.y-this.anchorOffsetY),s.scale(this.scaleX,this.scaleY),s.rotate(this.angle*Math.PI/180),r[a]=new e.Vector2D(s.tx,s.ty)}t[n]=r}return t},n.prototype.getLines=function(){var e=this.getCacheCollisionPolygonData(),t=e[0],n=t[0],r=t[1],a=t[2],i=t[3],s={p1x:n.x,p1y:n.y,p2x:r.x,p2y:r.y},o={p1x:r.x,p1y:r.y,p2x:a.x,p2y:a.y},l={p1x:a.x,p1y:a.y,p2x:i.x,p2y:i.y},c={p1x:i.x,p1y:i.y,p2x:n.x,p2y:n.y};return[s,o,l,c]},n.prototype.renderUpdate=function(){if(this.update){var e=this.container;e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,this.scaleContainer&&(e.scaleX=this.scaleX,e.scaleY=this.scaleY),e.rotation=this.angle,e.anchorOffsetX=this.width*this.anchorX,e.anchorOffsetY=this.height*this.anchorY,this.snapPixelsEnabled&&(e.x=e.x>>0,e.y=e.y>>0,e.width=e.width>>0,e.height=e.height>>0,e.anchorOffsetX=e.anchorOffsetX>>0,e.anchorOffsetY=e.anchorOffsetY>>0),e.alpha=this.alpha,e.visible=this.visible,this.update=!1}},Object.defineProperty(n.prototype,"box",{get:function(){return this.getBounds()},enumerable:!0,configurable:!0}),n.prototype.setIsColliding=function(t,n){if(this.collisionTarget=n,t&&(this.isCollsioning=t),this.isOldCollision!=t&&(this.isOldCollision=t,n&&t)){var r=new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCollisionWithOtherObject,{object:n});r.changeValue={},r.changeValue.object=n,this.dispatchEvent(r);var r=new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCollisionWithOtherObject,{object:this});r.changeValue={},r.changeValue.object=this,n.dispatchEvent(r)}},Object.defineProperty(n.prototype,"mirrored",{get:function(){return this._mirrored},set:function(e){if(this._mirrored!=e)switch(this._mirrored=e,this._mirrored){case 0:this.scaleX=-1;break;case 1:this.scaleY=-1;break;case 2:this.scaleX=-1,this.scaleY=-1;break;case 3:this.scaleX=1,this.scaleY=1}},enumerable:!0,configurable:!0}),n.prototype.getBehavior=function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t];if(n.constructor==e)return n}return null},n.prototype.addBehavior=function(e){return null!=e?("ls.ScrollToBehavior"==egret.getQualifiedClassName(e)&&(this.isHasCamera=!0),e.inst=this,e.enabled=e.enabled,this.isInScreenOnce=!1,this.behaviors.push(e),!0):!1},n.prototype.removeBehavior=function(e){if(null!=e){var t=this.behaviors.indexOf(e);if(-1!=t)return e=null,this.behaviors.splice(t,1)}return null},n.prototype.removeAllBehaviors=function(){for(var e=0;e<this.behaviors.length;e++){this.behaviors[e];this.global||(this.behaviors.splice(e,1),e--)}},Object.defineProperty(n.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x!=e&&(this._x=e,this.update=!0,this._updateX=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y!=e&&(this._y=e,this.update=!0,this._updateY=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width!=e&&(this._width=e,this.update=!0,this._updateWidth=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height!=e&&(this._height=e,this.update=!0,this._updateHeight=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"angle",{get:function(){return this._angle},set:function(e){this._angle!=e&&(this._angle=e,this.update=!0,this._updateAngle=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!=e&&(this._alpha=e,this.update=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!=e&&(this._visible=e,this.update=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e,this._scaleX=this._scaleY=e,this.update=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX!=e&&(this._scaleX=e,this.update=!0,this._updateScaleX=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY!=e&&(this._scaleY=e,this.update=!0,this._updateScaleY=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){this._anchorX!=e&&(this._anchorX=e,this._anchorOffsetX=this.width*e,this.update=!0,this._updateAnchorOffsetX=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchorOffsetX",{get:function(){return this._anchorOffsetX},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchorOffsetY",{get:function(){return this._anchorOffsetY},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){this._anchorY!=e&&(this._anchorY=e,this._anchorOffsetY=this.height*e,this.update=!0,this._updateAnchorOffsetY=!0)},enumerable:!0,configurable:!0}),n.prototype.isTouchDown=function(e){return{instances:[this],status:this._isTouchDown}},n.prototype.onButtonTap=function(e){return{instances:[this],status:!0}},n.prototype.onButtonBegin=function(e){return{instances:[this],status:!0}},n.prototype.onButtonEnd=function(e){return{instances:[this],status:!0}},n.prototype.onButtonMove=function(e){return{instances:[this],status:!0}},n.prototype.onButtonReleaseOutside=function(e){return{instances:[this],status:!0}},n.prototype.isEnabled=function(e){return{instances:[this],status:this.enabled}},n.prototype.isBetweenAngles=function(t){var n=e.eval_e(t.angle),r=e.eval_e(t.angle1),a=e.eval_e(t.angle2),i=this._isClosewideform(r,a);return i?{instances:[this],status:this._isClosewideform(n,r)&&this._isClosewideform(n,a)}:{instances:[this],status:this._isClosewideform(n,r)&&!this._isClosewideform(n,a)}},n.prototype.isclockwiseform=function(t){var n=e.eval_e(t.angle1),r=e.eval_e(t.angle2);return{instances:[this],status:this._isClosewideform(n,r)}},n.prototype._isClosewideform=function(t,n){var r=e.MathUtils.toRadian(t),a=e.MathUtils.toRadian(n),i=Math.sin(r),s=Math.cos(r),o=Math.sin(a),l=Math.cos(a);return 0>=s*o-i*l},n.prototype.isObjectMoving=function(e){var t=this.x,n=this.y;return this._oldX!=t||this._oldY!=n?(this._oldX=t,this._oldY=n,{instances:[this],status:!0}):{instances:[this],status:!1}},n.prototype.compareX=function(t){return{instances:[this],status:e.compare(this.x,t.operationType,t.x)}},n.prototype.compareY=function(t){return{instances:[this],status:e.compare(this.y,t.operationType,t.y)}},n.prototype.compareWidth=function(t){return{instances:[this],status:e.compare(this.width,t.operationType,t.width)}},n.prototype.compareHeight=function(t){return{instances:[this],status:e.compare(this.height,t.operationType,t.height)}},n.prototype.compareAlpha=function(t){return{instances:[this],status:e.compare(this.alpha,t.operationType,t.alpha)}},n.prototype.compareMirored=function(t){return{instances:[this],status:e.eval_e(t.mirrored)==this._mirrored}},n.prototype.compareObjectMoveAngle=function(t){var n=this.x,r=this.y,a=!1;if(isNaN(this._oldMoveX)||isNaN(this._oldMoveY))this._oldMoveX=n,this._oldMoveY=r;else if(this._oldMoveX!=n||this._oldMoveY!=r){var i=Math.atan2(r-this._oldMoveY,n-this._oldMoveX),s=e.MathUtils.toAngle(i);a=e.compare(s,t.operationType,t.angle),this._oldMoveX=n,this._oldMoveY=r}return{instances:[this],status:a}},n.prototype.compareObjectAngle=function(t){return{instances:[this],status:e.compare(this.angle,t.operationType,t.angle)}},n.prototype.compareTargetDistance=function(t){var n=e.eval_e(t.x),r=e.eval_e(t.y),a=n-this.x,i=r-this.y,s=Math.sqrt(a*a+i*i);return{instances:[this],status:e.compare(s,t.operationType,t.distance)}},n.prototype.onAddToStage=function(e){return{instances:[this],status:null!=this.container.stage||this._isAddToStage}},n.prototype.onRemoveToToStage=function(){return{instances:[this],status:!this.container.stage||!this._isAddToStage}},n.prototype.isOnScreenOrFalse=function(t){return{instances:[this],status:1===e.eval_e(t.isOnScreen)?this.isOnScreen:!this.isOnScreen}},n.prototype.isVisible=function(t){return{instances:[this],status:0!==e.eval_e(t.isVisible)}},n.prototype.onCollisionWithOtherObject=function(e){return{instances:[this,e.object],status:e.getStatus("object")}},n.prototype.onEnabledDisabledCollision=function(e){return{instances:[this],status:1==e.status}},n.prototype.isOverlappingOtherObject=function(e){return{instances:[this.collisionTarget,e.object],status:this.collisionTarget.name==e.object.name}},n.prototype.onTweenComplete=function(e){return{instances:[this],status:e.getStatus("key")}},n.prototype.pickByUniqueID=function(t){for(var n,r=e.World.getInstance().objectHash[this.name],a=0;a<r.length;a++){var i=r[a];if(i.id==e.eval_e(t.uniqueID)){n=i;break}}return{instances:[i],status:Boolean(n)}},n.prototype.onDestory=function(e){return{instances:[this],status:!0}},n.prototype.spawn=function(t,n,r,a,i){var s=e.eval_e(n),o=e.eval_e(r),l=e.eval_e(a),i=e.eval_e(i);e.assert("number"!=typeof s||"number"!=typeof o||"number"!=typeof l,"AIDisplayObject spawn parameter type incorrect!!");var c=t.clone();c.layer=s,1==i?(c.angle=this.angle,c.relyOnTarget=this):c.relyOnTarget=null;var h=e.MathUtils.angleTo(this.x,this.y,this.x+o,this.y+l),u=Math.sqrt(o*o+l*l),p=e.MathUtils.toRadian(c.angle)+e.MathUtils.toRadian(h);return c.x=this.x+Math.cos(p)*u,c.y=this.y+Math.sin(p)*u,c.initialize(),c.onCreate(),t.cloneBehavior(c),e.lakeshoreInst()[c.name]=c,e.World.getInstance().addChild(c),[c]},n.prototype.moveAtAngle=function(t,n){var r=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof r,"AIDisplayObject moveAtAngle parameter type incorrect!!"),e.assert("number"!=typeof a,"AIDisplayObject moveAtAngle parameter type incorrect!!");var i=e.MathUtils.toRadian(r);this.x+=Math.cos(i)*a*e.timeScale(),this.y+=Math.sin(i)*a*e.timeScale()},n.prototype.moveForward=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject moveForward parameter type incorrect!!");var r=e.MathUtils.toRadian(this.angle);this.x+=Math.cos(r)*n*e.timeScale(),this.y+=Math.sin(r)*n*e.timeScale()},n.prototype.moveToTargetPoint=function(t,n,r){var t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r);e.assert("number"!=typeof t||"number"!=typeof n||"number"!=typeof r,"AIDisplayObject moveToTargetPoint parameter type incorrect!!");var a=t-this.x,i=n-this.y,s=Math.sqrt(a*a+i*i);if(r>s)this.x=t,this.y=n;else{var o=Math.atan2(i,a);this.x+=Math.cos(o)*r*e.timeScale(),this.y+=Math.sin(o)*r*e.timeScale()}},n.prototype.rotateClockWise=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject rotateClockWise parameter type incorrect!!"),this.angle+=n*e.timeScale(),this.angle=e.MathUtils.clampAngle(this.angle)},n.prototype.rotateCounterClockWise=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject rotateCounterClockWise parameter type incorrect!!"),this.angle-=n*e.timeScale(),this.angle=e.MathUtils.clampAngle(this.angle)},n.prototype.rotateTowardAngle=function(t,n){var r=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof r||"number"!=typeof a,"AIDisplayObject rotateTowardAngle parameter type incorrect!!");var i=e.MathUtils.toAngle(e.MathUtils.angleRadius(e.MathUtils.toRadian(this.angle),e.MathUtils.toRadian(r),e.MathUtils.toRadian(a*e.timeScale())));isNaN(i)||this.angle!=i&&(this.angle=i)},n.prototype.rotateTowardPosition=function(t,n,r){var t=e.eval_e(t),n=e.eval_e(n),a=e.eval_e(r);e.assert("number"!=typeof t||"number"!=typeof n||"number"!=typeof a,"AIDisplayObject rotateTowardPosition parameter type incorrect!!");var i=e.MathUtils.angleTo(this.x,this.y,t,n),s=e.MathUtils.toAngle(e.MathUtils.angleRadius(e.MathUtils.toRadian(this.angle),e.MathUtils.toRadian(i),e.MathUtils.toRadian(a*e.timeScale())));isNaN(s)||this.angle!=s&&(this.angle=s)},n.prototype.setAngle=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setAngle parameter type incorrect!!"),this.angle=n},n.prototype.setAngleTowardPosition=function(t,n){var t=e.eval_e(t),n=e.eval_e(n);e.assert("number"!=typeof t||"number"!=typeof n,"AIDisplayObject setAngleTowardPosition parameter type incorrect!!");var r=e.MathUtils.angleTo(this.x,this.y,t,n);this.angle=r},n.prototype.setHeight=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setHeight parameter type incorrect!!"),this.height=n},n.prototype.setMirrored=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setMirrored parameter type incorrect!!"),this.mirrored=n},n.prototype.setPosition=function(t,n){var r=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof r||"number"!=typeof a,"AIDisplayObject setPosition parameter type incorrect!!"),this.x=r,this.y=a},n.prototype.setPositionToAnotherObject=function(t,n,r){var a=e.eval_e(n),i=e.eval_e(r),s=t instanceof e.AIObject?t:e.eval_e(t);e.assert("number"!=typeof a||"number"!=typeof a,"AIDisplayObject setPositionToAnotherObject parameter type incorrect!!"),this.x=s.x+a,this.y=s.y+i},n.prototype.setScale=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScale parameter type incorrect!!"),this.scale=n},n.prototype.setScaleX=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScaleX parameter type incorrect!!"),this.scaleX=n},n.prototype.setScaleY=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScaleY parameter type incorrect!!"),this.scaleY=n},n.prototype.setSize=function(t,n){var r=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof r||"number"!=typeof a,"AIDisplayObject setSize parameter type incorrect!!"),this.width=r,this.height=a},n.prototype.setVisible=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setVisible parameter type incorrect!!"),this.visible=1==n},n.prototype.setAlpha=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setAlpha parameter type incorrect!!"),1e-4>n&&(n=0),n>1&&(n=1),this.alpha=n},n.prototype.setWidth=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setWidth parameter type incorrect!!"),this.width=n},n.prototype.setX=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setX parameter type incorrect!!"),this.x=n},n.prototype.setY=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setY parameter type incorrect!!"),this.y=n},n.prototype.setEnabled=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setEnabled parameter type incorrect!!"),this.enabled=n>=1},n.prototype.setMask=function(e){e&&e instanceof n&&(this.container.mask=e.container)},n.prototype.setMaskByLayer=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);n&&(this.container.mask=n)},n.prototype.setMaskIsNull=function(){this.container.mask=null},n.prototype.addColorMatrixFilter=function(e){if(e){var t=e.split(",");if(t&&20==t.length){for(var n=[],r=0;r<t.length;r++)n[r]=+t[r];var a=new egret.ColorMatrixFilter(n);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(a)}}},n.prototype.addBlurFilter=function(t,n){t=e.eval_e(t),n=e.eval_e(n);var r=new egret.BlurFilter(t,n);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(r)},n.prototype.addDropShadowFilter=function(t,n,r,a,i,s,o,l,c,h,u){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),o=e.eval_e(o),l=e.eval_e(l),c=e.eval_e(c),h=e.eval_e(h),u=e.eval_e(u);var p=new egret.DropShadowFilter(t,n,r,a,i,s,o,l,c,h,u);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(p)},n.prototype.addGlowFilter=function(t,n,r,a,i,s,o,l){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),o=e.eval_e(o),l=e.eval_e(l);var c=new egret.GlowFilter(t,n,r,a,i,s,o,l);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(c)},n.prototype.removeFilterByType=function(t){if(t=e.eval_e(t),this.container.filters)for(var n=0,r=0;r<this.container.filters.length;r++){var a=this.container.filters[r];switch(t){case 0:a instanceof egret.ColorMatrixFilter&&(this.container.filters.splice(r-n,1),n++);break;case 1:a instanceof egret.BlurFilter&&(this.container.filters.splice(r-n,1),n++);break;case 2:a instanceof egret.DropShadowFilter&&(this.container.filters.splice(r-n,1),n++);break;case 3:a instanceof egret.GlowFilter&&(this.container.filters.splice(r-n,1),n++)}}},n.prototype.removeAllFilters=function(){this.container.filters=null},n.prototype.execTween=function(t,n,r,a,i,s,o,l,c,h,u,p,f,v,_){var y=t?e.eval_e(t):"lsTweenStartKey",d=e.eval_e(h),g=e.eval_e(u),m=e.eval_e(p),b=egret.Ease[g],x={};null!==n&&void 0!==n&&""!==n&&(x.x=e.eval_e(n)),null!==r&&void 0!==r&&""!==r&&(x.y=e.eval_e(r)),null!==a&&void 0!==a&&""!==a&&(x.anchorX=e.eval_e(a)),null!==i&&void 0!==i&&""!==i&&(x.anchorY=e.eval_e(i)),null!==s&&void 0!==s&&""!==s&&(x.width=e.eval_e(s)),null!==o&&void 0!==o&&""!==o&&(x.height=e.eval_e(o)),null!==l&&void 0!==l&&""!==l&&(x.angle=e.eval_e(l)),null!==c&&void 0!==c&&""!==c&&(x.alpha=e.eval_e(c)),null!==v&&void 0!==v&&""!==v&&(x.scaleX=e.eval_e(v)),null!==_&&void 0!==_&&""!==_&&(x.scaleY=e.eval_e(_));var E=arguments.callee.prototype;egret.setTimeout(function(){egret.Tween.get(this,{loop:1==f,onChange:null,onChangeObj:this}).to(x,d,b).wait(0).call(function(t){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onTweenComplete,{key:t})),E.onActionComplete&&E.onActionComplete()},this,[y])},this,m)},n.prototype.enabledDisabledCollision=function(t){var n=e.eval_e(t);this.collision=1==n},n.prototype.onAddToStageHanlder=function(e){this._isAddToStage=!0},n.prototype.onRemoveToStageHanlder=function(e){this._isAddToStage=!1},n.prototype.destoryTest=function(){this.destory()},n.prototype.destoryOnChangeScene=function(){this.removeAllBehaviors(),this.destory(!0)},n.prototype.destory=function(t){if(void 0===t&&(t=!1),t&&this.behaviors)for(var n=0;n<this.behaviors.length;n++){var r=this.behaviors[n];r.destory()}this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDestory)),this.container.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStageHanlder,this),this.container.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveToStageHanlder,this),e.World.getInstance().removeChild(this),this.global||(this.isDead=!0),this.onDestoryHanlder&&this.onDestoryHanlder()},n.prototype.saveToJSON=function(){var e=t.prototype.saveToJSON.call(this);e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.scale=this.scale,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.angle=this.angle,e.alpha=this.alpha,e.visible=this.visible,e.mirrored=this.mirrored,e.collision=this.collision,e.anchorX=this.anchorX,e.anchorY=this.anchorY,e.layer=this.layer,e.parallaxX=this.parallaxX,e.parallaxY=this.parallaxY,e.snapPixelsEnabled=this.snapPixelsEnabled,e.collisionData=this.collisionData,e.collisionType=this.collisionType,e.collisionSourceData=this.collisionSourceData,e.collisionIsRect=this.collisionIsRect,e.scaleContainer=this.scaleContainer,e.enabled=this.enabled,e.relyOnTarget=this.relyOnTarget,e.solidEnabeld=this.solidEnabeld,e.platformEnabled=this.platformEnabled,e.jumpthruEnabled=this.jumpthruEnabled,e.variables=JSON.stringify(this.variables),e.behaviors=[];for(var n=0;n<this.behaviors.length;n++){var r=this.behaviors[n];e.behaviors[n]=r.saveToJSON(),e.behaviors[n].plugin=egret.getQualifiedClassName(r)}return e},n.prototype.loadFromJSON=function(n){if(n){this.x=n.x,this.y=n.y,this.width=n.width,this.height=n.height,this.scale=n.scale,this.scaleX=n.scaleX,this.scaleY=n.scaleY,this.angle=n.angle,this.alpha=n.alpha,this.visible=n.visible,this.mirrored=n.mirrored,this.collision=n.collision,this.anchorX=n.anchorX,this.anchorY=n.anchorY,this.layer=n.layer,this.parallaxX=n.parallaxX,this.parallaxY=n.parallaxY,this.snapPixelsEnabled=n.snapPixelsEnabled,this.collisionData=n.collisionData,this.collisionType=n.collisionType,this.collisionSourceData=n.collisionSourceData,this.collisionVectorData=e.LayoutDecoder.decodeCollision(this,this.collisionData),this.collisionSourceVectorData=e.LayoutDecoder.decodeCollision(this,this.collisionSourceData),this.collisionIsRect=n.collisionIsRect,this.scaleContainer=n.scaleContainer,this.enabled=n.enabled,this.relyOnTarget=n.relyOnTarget,this.solidEnabeld=n.solidEnabeld,this.platformEnabled=n.platformEnabled,this.jumpthruEnabled=n.jumpthruEnabled,this.variables=JSON.parse(n.variables);
for(var r in this.variables)this[r]=this.variables[r];this.removeAllBehaviors();for(var a=0;a<n.behaviors.length;a++){var i=n.behaviors[a],s=i.plugin.slice(3),o=e.getInstanceByPluginClassName(s);o.loadFromJSON(i);for(var l=-1,c=0;c<this.behaviors.length;c++)if(egret.getQualifiedClassName(this.behaviors[c])==egret.getQualifiedClassName(o)){l=c;break}-1!=l&&(this.addBehavior(o),o.onCreate())}t.prototype.loadFromJSON.call(this,n)}},n.prototype.clone=function(){var e=t.prototype.clone.call(this);return e.name=this.name,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.scale=this.scale,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.angle=this.angle,e.alpha=this.alpha,e.visible=this.visible,e.mirrored=this.mirrored,e.anchorX=this.anchorX,e.anchorY=this.anchorY,e.layer=this.layer,e.parallaxX=this.parallaxX,e.parallaxY=this.parallaxY,e.global=this.global,e.collisionData=this.collisionData,e.collisionType=this.collisionType,e.collisionSourceData=this.collisionSourceData,e.collisionVectorData=this.collisionVectorData,e.collisionSourceVectorData=this.collisionSourceVectorData,e.collisionIsRect=this.collisionIsRect,e.scaleContainer=this.scaleContainer,e.enabled=this.enabled,e.collision=this.collision,e.relyOnTarget=this.relyOnTarget,e.snapPixelsEnabled=this.snapPixelsEnabled,e.solidEnabeld=this.solidEnabeld,e.platformEnabled=this.platformEnabled,e.jumpthruEnabled=this.jumpthruEnabled,e},n.prototype.cloneBehavior=function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t],r=n.clone();e.addBehavior(r),r.isCreated||(r.isCreated=!0,r.onCreate())}},n}(e.AIObject);e.AIDisplayObject=t,__reflect(t.prototype,"ls.AIDisplayObject");var n=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsButtonDownEvent=n,__reflect(n.prototype,"ls.IsButtonDownEvent");var r=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnButtonTapEvent=r,__reflect(r.prototype,"ls.OnButtonTapEvent");var a=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnButtonBeginEvent=a,__reflect(a.prototype,"ls.OnButtonBeginEvent");var i=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnButtonEndEvent=i,__reflect(i.prototype,"ls.OnButtonEndEvent");var s=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnButtonMoveEvent=s,__reflect(s.prototype,"ls.OnButtonMoveEvent");var o=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnButtonReleaseOutsideEvent=o,__reflect(o.prototype,"ls.OnButtonReleaseOutsideEvent");var l=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsButtonEnabledEvent=l,__reflect(l.prototype,"ls.IsButtonEnabledEvent");var c=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsBetweenAnglesEvent=c,__reflect(c.prototype,"ls.IsBetweenAnglesEvent");var h=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsClockwiseFromEvent=h,__reflect(h.prototype,"ls.IsClockwiseFromEvent");var u=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsObjectMovingEvent=u,__reflect(u.prototype,"ls.IsObjectMovingEvent");var p=function(e){function t(){var t=e.apply(this,arguments)||this;return t.x=0,t}return __extends(t,e),t}(e.BaseEvent);e.CompareXPosEvent=p,__reflect(p.prototype,"ls.CompareXPosEvent");var f=function(e){function t(){var t=e.apply(this,arguments)||this;return t.y=0,t}return __extends(t,e),t}(e.BaseEvent);e.CompareYPosEvent=f,__reflect(f.prototype,"ls.CompareYPosEvent");var v=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareWidthEvent=v,__reflect(v.prototype,"ls.CompareWidthEvent");var _=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareHeightEvent=_,__reflect(_.prototype,"ls.CompareHeightEvent");var y=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareOpacityEvent=y,__reflect(y.prototype,"ls.CompareOpacityEvent");var d=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareMirroredStatusEvent=d,__reflect(d.prototype,"ls.CompareMirroredStatusEvent");var g=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareObjectMoveAngleEvent=g,__reflect(g.prototype,"ls.CompareObjectMoveAngleEvent");var m=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareObjectAngleEvent=m,__reflect(m.prototype,"ls.CompareObjectAngleEvent");var b=function(e){function t(){var t=e.apply(this,arguments)||this;return t.x=0,t.y=0,t.distance=0,t}return __extends(t,e),t}(e.BaseEvent);e.CompareTargetDistanceEvent=b,__reflect(b.prototype,"ls.CompareTargetDistanceEvent");var x=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnStartOfLayoutEvent=x,__reflect(x.prototype,"ls.OnStartOfLayoutEvent");var E=function(e){function t(){var t=e.apply(this,arguments)||this;return t.isOnScreen=1,t}return __extends(t,e),t}(e.BaseEvent);e.IsOnScreenEvent=E,__reflect(E.prototype,"ls.IsOnScreenEvent");var C=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsVisibleEvent=C,__reflect(C.prototype,"ls.IsVisibleEvent");var I=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnCollisionWithOtherObjectEvent=I,__reflect(I.prototype,"ls.OnCollisionWithOtherObjectEvent");var O=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnEnabledDisabledCollisionEvent=O,__reflect(O.prototype,"ls.OnEnabledDisabledCollisionEvent");var S=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsOverlappingOtherObjectEvent=S,__reflect(S.prototype,"ls.IsOverlappingOtherObjectEvent");var T=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.PickByUniqueIDEvent=T,__reflect(T.prototype,"ls.PickByUniqueIDEvent");var w=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnDestoryEvent=w,__reflect(w.prototype,"ls.OnDestoryEvent");var D=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnTweenCompleteEvent=D,__reflect(D.prototype,"ls.OnTweenCompleteEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(){function e(){}return e}();e.loopSelections=t,__reflect(t.prototype,"ls.loopSelections");var n=function(e){function t(){var t=e.call(this)||this;return t.index=0,t.instances={},t}return __extends(t,e),t}(e.BaseClass);e.Action=n,__reflect(n.prototype,"ls.Action")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.enabled=1,n.isCreated=!1,n.renderEnabled=!0,e.Trigger.register(n),n}return __extends(n,t),n.prototype.onCreate=function(){},n.prototype.tick=function(){},n.prototype.saveToJSON=function(){return{enabled:this.enabled,name:this.name,paramInstances:this.paramInstances}},n.prototype.loadFromJSON=function(e){e&&(this.enabled=e.enabled,this.name=e.name,this.paramInstances=e.paramInstances)},n.prototype.getClass=function(){return this.constructor},n.prototype.destory=function(){},n.prototype.clone=function(){var e=this.getClass(),t=new e;return t.name=this.name,t.enabled=this.enabled,t.paramInstances=this.paramInstances,t},n}(egret.EventDispatcher);e.BaseBehavior=t,__reflect(t.prototype,"ls.BaseBehavior")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){this.radius=0}return e}();e.Circle=t,__reflect(t.prototype,"ls.Circle");var n=function(){function n(){}return n.checkCollision=function(t,n){if(!t||!n||t==n)return!1;if(!t.intersects(n))return!1;new e.Vector2D(t.x,t.y),new e.Vector2D(n.x,n.y);return 0==t.collisionType&&0==n.collisionType?this.checkPolygonCollisionPolygon(t,n):1==t.collisionType&&1==n.collisionType?this.checkCircleCollisionCircle(t,n):2==t.collisionType&&2==n.collisionType?this.checkDotCollisionDot(t,n):0==t.collisionType&&1==n.collisionType?this.checkCircleCollisionPolygon(n,t):1==t.collisionType&&0==n.collisionType?this.checkCircleCollisionPolygon(t,n):0==t.collisionType&&2==n.collisionType?this.checkDotCollisionPolygon(n,t):2==t.collisionType&&0==n.collisionType?this.checkDotCollisionPolygon(t,n):1==t.collisionType&&2==n.collisionType?this.checkDotCollisionCircle(n,t):2==t.collisionType&&1==n.collisionType?this.checkDotCollisionCircle(t,n):!1},n.checkPolygonCollisionPolygon=function(t,n){var r=!1,a=t.getCacheCollisionPolygonData();if(null==a)return!1;var i=n.getCacheCollisionPolygonData();if(null==i)return!1;for(var s=0;s<a.length;s++){for(var o=a[s],l=0;l<i.length;l++){var c=i[l];if(r=e.SAT.sat(new e.Vector2D(t.x,t.y),new e.Vector2D(n.x,n.y),o,c))break}if(r)break}return r},n.isCollsionWithRect=function(e,t,n,r,a,i,s,o){return e>=a&&e>=a+s?!1:a>=e&&a>=e+n?!1:t>=i&&t>=i+o?!1:i>=t&&i>=t+r?!1:!0},n.checkDotCollisionDot=function(t,n){var r=t.collisionVectorData,a=n.collisionVectorData,i=t.angle*Math.PI/180,s=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(r.x-t.anchorOffsetX,r.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(i);var l=new egret.Matrix;l.translate(a.x-n.anchorOffsetX,a.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(s);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty);return c.equals(h)},n.checkDotCollisionCircle=function(t,n){var r=t.collisionVectorData,a=n.collisionVectorData,i=t.angle*Math.PI/180,s=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(r.x-t.anchorOffsetX,r.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(i);var l=new egret.Matrix;l.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(s);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty),u=c.distanceSQ(h),p=a.radius*n.scale;return p*p>=u},n.checkDotCollisionPolygon=function(t,n){var r=t.collisionVectorData,a=t.angle*Math.PI/180,i=n.angle*Math.PI/180,s=new egret.Matrix;s.translate(r.x-t.anchorOffsetX,r.y-t.anchorOffsetY),s.scale(t.scaleX,t.scaleY),s.rotate(a);var o=new e.Vector2D(t.x+s.tx,t.y+s.ty),l=n.collisionVectorData,c=!1,h=0;if(l){for(var u=0;u<l.length;u++){for(var p=l[u],f=0;f<p.length;f++){var v=p[f],_=(f+1)%p.length,y=new egret.Matrix;y.translate(v.x-n.anchorOffsetX,v.y-n.anchorOffsetY),y.scale(n.scaleX,n.scaleY),y.rotate(i);var d=new egret.Matrix;d.translate(p[_].x-n.anchorOffsetX,p[_].y-n.anchorOffsetY),d.scale(n.scaleX,n.scaleY),d.rotate(i);var g=new e.Vector2D(n.x+y.tx,n.y+y.ty),m=new e.Vector2D(n.x+d.tx,n.y+d.ty);if(g.y!=m.y&&!(o.y<(g.y<m.y?g.y:m.y)||o.y>=(g.y>m.y?g.y:m.y))){var b=(o.y-g.y)*(m.x-g.x)/(m.y-g.y)+g.x;b>o.x&&h++}}c=h%2==1}return c}return!1},n.checkCircleCollisionCircle=function(t,n){var r=t.collisionVectorData,a=n.collisionVectorData,i=t.angle*Math.PI/180,s=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(r.center.x-t.anchorOffsetX,r.center.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(i);var l=new egret.Matrix;l.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(s);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty),u=c.distanceSQ(h),p=r.radius*t.scale,f=a.radius*n.scale;return(p+f)*(p+f)>=u},n.checkCircleCollisionPolygon=function(n,r){var a=n.collisionVectorData,i=n.angle*Math.PI/180,s=r.angle*Math.PI/180,o=a.radius*n.scale,l=!1,c=r.collisionVectorData,h=new egret.Matrix;h.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),h.scale(n.scaleX,n.scaleY),h.rotate(i);var u=new e.Vector2D(n.x+h.tx,n.y+h.ty);if(c){for(var p=0;p<c.length;p++){for(var f=c[p],v=0;v<f.length;v++){var _=f[v],y=new egret.Matrix;y.translate(_.x-r.anchorOffsetX,_.y-r.anchorOffsetY),y.scale(r.scaleX,r.scaleY),y.rotate(s);var _=new e.Vector2D(y.tx+r.x,y.ty+r.y);if(u.distanceSQ(_)<=o*o){l=!0;break}var d=(v+1)%f.length,g=new egret.Matrix;g.translate(f[d].x-r.anchorOffsetX,f[d].y-r.anchorOffsetY),g.scale(r.scaleX,r.scaleY),g.rotate(s);var m=new e.Vector2D(r.x+y.tx,r.y+y.ty),b=new e.Vector2D(r.x+g.tx,r.y+g.ty),x=new t;if(x.center=new e.Vector2D(n.x+h.tx,n.y+h.ty),x.radius=a.radius*n.scale,this.circleCollisionLine(x,m,b)){l=!0;break}}if(l)break}return l}return!1},n.circleCollisionLine=function(e,t,n){var r=e.center.x-t.x,a=e.center.y-t.y,i=n.x-t.x,s=n.y-t.y,o=Math.sqrt(i*i+s*s);i/=o,s/=o;var l=r*i+a*s,c=0,h=0;return 0>=l?(c=t.x,h=t.y):l>=o?(c=n.x,h=n.y):(c=t.x+i*l,h=t.y+s*l),(e.center.x-c)*(e.center.x-c)+(e.center.y-h)*(e.center.y-h)<=e.radius*e.radius},n.pointToSegDist=function(e,t,n,r,a,i){var s=(a-n)*(e-n)+(i-r)*(t-r);if(0>=s)return Math.sqrt((e-n)*(e-n)+(t-r)*(t-r));var o=(a-n)*(a-n)+(i-r)*(i-r);if(s>=o)return Math.sqrt((e-a)*(e-a)+(t-i)*(t-i));var l=s/o,c=n+(a-n)*l,h=r+(i-r)*l;return Math.sqrt((e-c)*(e-c)+(h-r)*(h-r))},n.distFromPointToLine=function(e,t,n){var r=n.x-t.x,a=n.y-n.x,i=n.x*t.y-t.x*n.y;return Math.abs(r*e.x+a*e.y+i)/Math.sqrt(r*r+a*a)},n}();e.Collision=n,__reflect(n.prototype,"ls.Collision")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){this.tlx=0,this.tly=0,this.trx=0,this.try_=0,this.brx=0,this.bry=0,this.blx=0,this.bly=0,this.minresult=0,this.maxresult=0,this._circle_radius=10}return Object.defineProperty(e.prototype,"circle_radius",{get:function(){return this._circle_radius},enumerable:!0,configurable:!0}),e.prototype.offset=function(e,t){return this.tlx+=e,this.tly+=t,this.trx+=e,this.try_+=t,this.brx+=e,this.bry+=t,this.blx+=e,this.bly+=t,this},e.prototype.set_from_rect=function(e){this.tlx=e.left,this.tly=e.top,this.trx=e.right,this.try_=e.top,this.brx=e.right,this.bry=e.bottom,this.blx=e.left,this.bly=e.bottom;var t=this.trx-this.tlx,n=this.bry-this.try_;this._circle_radius=Math.sqrt(t*t+n*n)},e.prototype.set_from_rotated_rect=function(e,t){if(0===t)this.set_from_rect(e);else{var n=Math.sin(t),r=Math.cos(t),a=e.left*n,i=e.top*n,s=e.right*n,o=e.bottom*n,l=e.left*r,c=e.top*r,h=e.right*r,u=e.bottom*r;this.tlx=l-i,this.tly=c+a,this.trx=h-i,this.try_=c+s,this.brx=h-o,this.bry=u+s,this.blx=l-o,this.bly=u+a}},e.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4},e.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4},e.prototype.at=function(e,t){if(t)switch(e){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(e){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}},e.prototype.minmax4=function(e,t,n,r){t>e?r>n?(n>e?this.minresult=e:this.minresult=n,t>r?this.maxresult=t:this.maxresult=r):(r>e?this.minresult=e:this.minresult=r,t>n?this.maxresult=t:this.maxresult=n):r>n?(n>t?this.minresult=t:this.minresult=n,e>r?this.maxresult=e:this.maxresult=r):(r>t?this.minresult=t:this.minresult=r,e>n?this.maxresult=e:this.maxresult=n)},e.prototype.bounding_box=function(e){this.minmax4(this.tlx,this.trx,this.brx,this.blx),e.left=this.minresult,e.right=this.maxresult,this.minmax4(this.tly,this.try_,this.bry,this.bly),e.top=this.minresult,e.bottom=this.maxresult},e.prototype.contains_pt=function(e,t){var n=this.tlx,r=this.tly,a=this.trx-n,i=this.try_-r,s=this.brx-n,o=this.bry-r,l=e-n,c=t-r,h=a*a+i*i,u=a*s+i*o,p=a*l+i*c,f=s*s+o*o,v=s*l+o*c,_=1/(h*f-u*u),y=(f*p-u*v)*_,d=(h*v-u*p)*_;if(y>=0&&d>0&&1>y+d)return!0;a=this.blx-n,i=this.bly-r;var h=a*a+i*i,u=a*s+i*o,p=a*l+i*c;return _=1/(h*f-u*u),y=(f*p-u*v)*_,d=(h*v-u*p)*_,y>=0&&d>0&&1>y+d},e.prototype.segments_intersect=function(e,t,n,r,a,i,s,o){var l,c,h,u,p,f,v,_;if(n>e?(c=e,l=n):(c=n,l=e),s>a?(f=a,p=s):(f=s,p=a),f>l||c>p)return!1;if(r>t?(u=t,h=r):(u=r,h=t),o>i?(_=i,v=o):(_=o,v=i),_>h||u>v)return!1;var y=a-e+s-n,d=i-t+o-r,g=n-e,m=r-t,b=s-a,x=o-i,E=Math.abs(m*b-x*g),C=b*d-x*y;if(Math.abs(C)>E)return!1;var I=g*d-m*y;return Math.abs(I)<=E},e.prototype.intersects_segment=function(e,t,n,r){if(this.contains_pt(e,t)||this.contains_pt(n,r))return!0;var a,i,s,o,l;for(l=0;4>l;l++)if(a=this.at(l,!0),i=this.at(l,!1),s=this.at(l+1,!0),o=this.at(l+1,!1),this.segments_intersect(e,t,n,r,a,i,s,o))return!0;return!1},e.prototype.intersects_quad=function(e){var t=e.midX(),n=e.midY();if(this.contains_pt(t,n))return!0;var r=this.midX(),a=this.midY();if(e.contains_pt(r,a))return!0;var i=t-r,s=n-a,o=i*i+s*s,l=this.circle_radius+e.circle_radius;if(l*l>o)return!0;var c,h,u,p,f,v,_,y,d,g;for(d=0;4>d;d++)for(g=0;4>g;g++)if(c=this.at(d,!0),h=this.at(d,!1),u=this.at(d+1,!0),p=this.at(d+1,!1),f=e.at(g,!0),v=e.at(g,!1),_=e.at(g+1,!0),y=e.at(g+1,!1),this.segments_intersect(c,h,u,p,f,v,_,y))return!0;return!1},e}();e.Quad=t,__reflect(t.prototype,"ls.Quad")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(e,t,n,r){}return e.prototype.getTreeBoundInfo=function(e){},e}();e.QuadTree=t,__reflect(t.prototype,"ls.QuadTree")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){this.intersectionIndex=-1,this.intersectionPoint=new e.Vector2D}return t.prototype.getPrevIndex=function(e,t){return(e-1+t)%t},t.prototype.getNextIndex=function(e,t){return(e+1)%t},t.prototype.isConcavePoly=function(e){return e.length<=3?!1:this.getNextConcaveIndex(e,0)>=0},t.prototype.onSeparateConcavePoly=function(e){var t=[];return this.isAntiClockDir(e)||e.reverse(),this.separateConcavePoly(e,t,0),t},t.prototype.getNextConcaveIndex=function(e,t){if(void 0===t&&(t=0),e.length<=3)return-1;for(var n=e.length,r=n+t,a=t;r>a;a++){var i=this.getPrevIndex(a,n),s=this.getNextIndex(a,n),o=(a+n)%n,l=this.getMultiPtClockDir(e[o],e[i],e[s]);if(1==l)return a%n}return-1},t.prototype.getAllConvaveIndex=function(e,t){if(void 0===t&&(t=0),e.length<=3)return[];for(var n=[],r=e.length,a=r+t,i=t;a>i;i++){var s=this.getPrevIndex(i,r),o=this.getNextIndex(i,r),l=(i+r)%r,c=this.getMultiPtClockDir(e[l],e[s],e[o]);1==c&&n.push(i%r)}return n},t.prototype.separateConcavePoly=function(e,t,n){if(e.length<=3)return void t.push(e);var r=this.getNextConcaveIndex(e,n);if(n=r+1,0>r)return void t.push(e);if(this.getSplitPointByRgnBCinter(e,r)){var a=[],i=[];return this.splitPolyByIntersection(e,r,a,i),this.separateConcavePoly(a,t,n),void this.separateConcavePoly(i,t,n)}t.push(e)},t.prototype.splitPolyByIntersection=function(e,t,n,r){var a=e.length;if(0>t||t>=a)return!1;if(this.intersectionIndex<0||this.intersectionIndex>=a)return!1;if(t<=this.intersectionIndex+1)for(var i=this.intersectionIndex,a=t+a;a>=i;i++)n.push(e[i%a]);else for(var i=this.intersectionIndex;t>=i;i++)n.push(e[i]);if(t<=this.intersectionIndex)for(var i=t;i<this.intersectionIndex;i++)r.push(e[i]);else for(var i=t;i<this.intersectionIndex+a;i++)r.push(e[i%a]);return e[this.intersectionIndex].equals(this.intersectionPoint)||(n.push(this.intersectionPoint),r.push(this.intersectionPoint)),!0},t.prototype.getSplitPointByRgnBCinter=function(t,n){if(t.length<=3)return!1;for(var r=t.length,a=(n-1+r)%r,i=(n+1)%r,s=[],o=[],l=[],c=[],h=[],u=[],p=[],f=[],v=a>i?a:a+r,_=i;v>_;_++){var y=_%r,d=this.getMultiPtClockDir(t[n],t[a],t[y]),g=this.getMultiPtClockDir(t[n],t[i],t[y]);0>d&&g>0?s.push(y):d>=0&&g>=0?o.push(y):0>=d&&0>g?l.push(y):c.push(y)}if(h=this.getVisiblePtsOnRegion(t,n,s),u=o.concat(),f=c.concat(),p=this.getVisiblePtsOnRegion(t,n,l),h.length>0){var m=[],b=[];if(this.setSplitByRegion(t,h,m,b),b.length>0?this.intersectionIndex=this.getBestIntersectionPt(t,n,b):this.intersectionIndex=this.getBestIntersectionPt(t,n,m),this.intersectionIndex<0||this.intersectionIndex>=r)return!1}if(u.length<1||p.length<1)return console.error("BC分区为空错误！！"),!1;var x=u[u.length-1],E=p[0],C=new e.Vector2D(t[E].x-t[x].x,t[E].y-t[x].y),I=new e.Vector2D(t[n].x-t[a].x,t[n].y-t[a].y),O=new e.Vector2D(t[n].x-t[i].x,t[n].y-t[i].y),S=new e.Vector2D(I.x+O.x>>1,I.y+O.y>>1),T=new e.Vector2D;return 1!=this.getCrossByRadialAndSegment(t[n],S,t[x],C,T)?!1:(this.intersectionIndex=x,this.intersectionPoint=T,!0)},t.prototype.getMultiPtClockDir=function(e,t,n){var r=(e.x-t.x)*(n.y-e.y)-(n.x-e.x)*(e.y-t.y);return r>0?1:0>r?-1:0},t.prototype.getMultiPtClockDirByIndex=function(e,t){if(e.length<=2)return 0;var n=e[t%e.length],r=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length];return this.getMultiPtClockDir(n,r,a)},t.prototype.isAntiClockDir=function(e){if(e.length<=2)return!0;for(var t=0,n=1,r=e.length;r>n;n++){var a=(n+1)%r,i=(n+2)%r,s=(e[a].x-e[n].x)*(e[i].y-e[a].y);s-=(e[a].y-e[n].y)*(e[i].x-e[a].x),0>s?t--:s>0&&t++}return 0>=t},t.prototype.isInsection=function(t,n,r,a){var i=new e.Vector2D(r.x-t.x,r.y-t.y),s=n.x*a.y-n.y*a.x,o=s*s,l=n.x*n.x+n.y*n.y,c=a.x*a.x+a.y*a.y;if(o>.01*l*c){var h=(i.x*a.y-i.y*a.x)/s;if(0>h||h>1)return 0;var u=(i.x*n.y-t.y*n.x)/s;return 0>u||u>1?0:1}return 0},t.prototype.isVisiblePtOnConcave=function(e,t,n){for(var r=0,a=e.length;a>r;r++){var i=(r+1)%a;if(r!=t&&r!=n&&i!=t&&i!=n&&this.isInsection(e[t],e[n],e[r],e[i]))return!1}return!0},t.prototype.getVisiblePtsOnRegion=function(e,t,n){for(var r=[],a=0,i=n.length;i>a;a++)this.isVisiblePtOnConcave(e,t,n[a])&&r.push(n[a]);return r},t.prototype.setSplitByRegion=function(e,t,n,r){for(var a=0,i=e.length;i>a;a++)this.getMultiPtClockDirByIndex(e,t[a])?n.push(t[a]):r.push(t[a])},t.prototype.dotProd=function(e,t){return e.dotProd(t)},t.prototype.getBestIntersectionPt=function(e,t,n){if(n.length<1)return-1;for(var r=e.length,a=(t-1+r)%r,i=(t+1)%r,s=e[t].clone().substruct(e[a].x,e[a].y).normalize(),o=(e[t].clone().substruct(e[i].x,e[i].y).normalize(),-1),l=-1,c=0,h=n.length;h>c;c++){var u=n[c],p=e[u],f=p.clone().substruct(e[t].x,e[t].y).normalize(),v=s.clone().dotProd(f);v>l&&(o=u)}return o},t.prototype.getCrossByRadialAndSegment=function(e,t,n,r,a){var i=n.clone().substruct(e.x,e.y),s=t.getCross(r);if(s*s>.01*t.lengthSQ*r.lengthSQ){var o=i.getCross(r)/s;if(0>o)return 0;var l=i.getCross(t)/s;if(0>l||l>1)return 0;var c=t.clone().scale(o);return a.x=e.x+c.x,a.y=e.y+c.y,1}return 0},t.prototype.getPosRelationToLine=function(e,t,n){return n.x*(t.y-e.y)+n.y*(e.x-t.x)+n.y*t.x-n.x*t.y},t}();e.IntersectionStruct=t,__reflect(t.prototype,"ls.IntersectionStruct")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return t.sat=function(e,t,n,r){return n.length<1||r.length<1?!1:this.convexsat(e,t,n,r)},t.convexsat=function(e,t,n,r){if(n.length<1||r.length<2)return!1;var a=[];a=this.getUniqueAxis(n,a),a=this.getUniqueAxis(r,a);for(var i=0,s=a.length;s>i;i++){var o=this.getProjection(e,n,a[i]),l=this.getProjection(t,r,a[i]);if(!this.overlap(o,l))return!1}return!0},t.getUniqueAxis=function(t,n){for(var r,a=!1,r=new e.Vector2D,i=0,s=t.length;s>i;i++){var r=t[(i+1)%s].clone().substruct(t[i].x,t[i].y).normalize().perp;r.x<=0&&(0==r.x?r.y<0&&(r.y*=-1):(r.x*=-1,r.y*=-1)),a=!0;for(var o=0,l=n.length;l>o;o++)if(n[o].equals(r)){a=!1;break}a&&n.push(r)}return n},t.overlap=function(e,t){return e.x>t.y?!1:e.y<t.x?!1:(e.x-t.x)*(t.x-t.y)<0?!0:!0},t.getPolyBound=function(e){if(e.length<1)return[0,0,0,0];for(var t=e[0],n=[t.x,t.y,t.x,t.y],r=0;r<e.length;r++){var a=e[r];a.x<n[0]&&(n[0]=a.x),a.y<n[1]&&(n[1]=a.y),a.x>n[2]&&(n[2]=a.x),a.y>n[3]&&(n[3]=a.y)}return n},t.getCircleBound=function(e){if(2!==e.length)return[0,0,0,0];var t=e[0],n=e[1];return[t.x-n.x,t.y-n.x,t.x+n.x,t.y+n.x]},t.getProjection=function(t,n,r){var a,i,s=0;i=new e.Vector2D(n[0].x+t.x,n[0].y+t.y).dotProd(r),s=i;for(var o=0;o<n.length;o++)a=new e.Vector2D(n[o].x+t.x,n[o].y+t.y).dotProd(r),i>a&&(i=a),a>s&&(s=a);return new e.Vector2D(i,s)},t}();e.SAT=t,__reflect(t.prototype,"ls.SAT")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.isTrigger=!1,t.triggerStatus=!1,t.isInvert=!1,t.operatorType=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"isFirstCondition",{get:function(){return 0===this.index},enumerable:!0,configurable:!0}),t}(e.BaseClass);e.Condition=t,__reflect(t.prototype,"ls.Condition")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){this.status=!1,this.loopDatas=[],this.loopLayer=0,this.persistent=!0,this._checked=!1,this._checkall=!1,this.execActionIndex=0,this.searchInstances={}}return Object.defineProperty(t.prototype,"loop",{get:function(){if(null==this.conditions)return!1;for(var e=0,t=this.conditions.length;t>e;e++){var n=this.conditions[e];if(n.loop)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkall",{get:function(){if(!this._checked){for(var e=0,t=this.conditions.length;t>e;e++){var n=this.conditions[e];if(1==n.operatorType){this._checkall=!0;break}}this._checked=!0}return this._checkall},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isloop",{get:function(){return this.loopDatas&&this.loopDatas.length?this.loopDatas[0]instanceof e.ForEvent:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isArray",{get:function(){return this.loopDatas&&this.loopDatas.length?this.loopDatas[0]instanceof e.OnForEachArrayElementEvent:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"action",{get:function(){return this.actions[this.execActionIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"world",{get:function(){return e.World.getInstance()},enumerable:!0,configurable:!0}),t.prototype.execActions=function(e){this.actions&&(this.lastActionResults=[],this.execActionIndex=0,this.filterinstances=e,this.isloop?this.execloop():this.isArray?this.execArray():this.execNextAction())},t.prototype.execloop=function(){var e=[];e[0]=[],e[1]=[],e[2]=[];for(var t=0;t<this.loopLayer;t++){var n=this.loopDatas[t],r=Math.min(n.startIndex,n.endIndex),a=Math.max(n.startIndex,n.endIndex);e[0][t]=r,e[1][t]=a,e[2][t]=n}this.execloopLayer(e,0)},t.prototype.execloopLayer=function(t,n){for(var r=t[0][n],a=t[1][n];a>r;r++){var i=t[2][n];e.loopIndex[i.name]=r,n==this.loopLayer-1?(this.execActionIndex=0,this.lastActionResults=[],this.execNextAction()):this.execloopLayer(t,n+1)}},t.prototype.execArray=function(){var t=this.loopDatas[0],n=e.eval_e(t.xyzDimention),r=t.array;switch(n){case 1:for(var a=0,i=r.width;i>a;a++)r.curX=a,r.curValue=r.at(a,0,0),this.execActionIndex=0,this.lastActionResults=[],this.execNextAction();break;case 2:for(var a=0,i=r.width;i>a;a++){r.curX=a;for(var s=0,o=r.height;o>s;s++)r.curY=s,r.curValue=r.at(a,s,0),this.execActionIndex=0,this.lastActionResults=[],this.execNextAction()}break;case 3:for(var a=0,i=r.width;i>a;a++){r.curX=a;for(var s=0,o=r.height;o>s;s++){r.curY=s;for(var l=0,c=r.depth;c>l;l++)r.curZ=l,r.curValue=r.at(a,s,l),this.execActionIndex=0,this.lastActionResults=[],this.execNextAction()}}break;default:e.assert(!0,"无法解析当前数组维数："+n)}},t.prototype.execNextAction=function(){if(!(this.execActionIndex>=this.actions.length)){var t=this.action,n=this.world,r=t.callHanlderName,a=[];if("wait"===r){var i=e.EventSheetDecoder.decodeActionParams(t).params,s=e.eval_e(i[0]);return"number"!=typeof s&&(s=0),void egret.setTimeout(function(){this.execActionIndex++,this.execNextAction()},this,1e3*s)}var o=[];if(t.isFamily){for(var l=[],c=0,h=t.callTargets.length;h>c;c++)for(var u=t.callTargets[c],p=u.name,f=n.objectHash[p],v=0,_=f.length;_>v;v++)l.push(f[v]);a=o.concat(l)}else a=o.concat(t.callTargets);this.searchInstances={};for(var c=0,y=a.length;y>c;c++){for(var d=a[c],g=-1,v=0,m=this.filterinstances.length;m>v;v++){var u=this.filterinstances[v];d.name===u.name&&(this.searchInstances[u.u_id]=u,g=v)}if(-1==g){var b,x=d.name;if(b=e.isSingleInst(x)?[e.getInstanceByInstanceName(x)]:n.objectHash[x])for(var v=0,E=b.length;E>v;v++){var C=b[v];this.searchInstances[C.u_id]=C}}}if(this.lastActionResults){for(var I in this.searchInstances)for(var O=this.searchInstances[I],v=0,m=this.lastActionResults.length;m>v;v++){var S=this.lastActionResults[v];O.name===S.name&&delete this.searchInstances[O.u_id]}for(var c=0,y=this.lastActionResults.length;y>c;c++){var S=this.lastActionResults[c];this.searchInstances[S.u_id]=S}}if(t.isBehaviorExecAction){var T=t.callTargetBehavior[r];for(var I in this.searchInstances){var w=this.searchInstances[I];if(t.isFamily){e.lakeshoreInst()[w.name]=w;var D=w.getBehavior(t.callTargetBehavior.constructor);if(T&&D){var i=e.EventSheetDecoder.decodeActionParams(t).params;this.execLastActionResult(T.apply(D,i))}}else if(w.name===t.callTargets.name){e.lakeshoreInst()[w.name]=w;var D=w.getBehavior(t.callTargetBehavior.constructor);if(T&&D){var i=e.EventSheetDecoder.decodeActionParams(t).params;this.execLastActionResult(T.apply(D,i))}}}}else for(var I in this.searchInstances){var w=this.searchInstances[I];if(t.isFamily||w.name==t.callTargets.name){e.lakeshoreInst()[w.name]=w;var T=w[r];if(T){var i=e.EventSheetDecoder.decodeActionParams(t).params;this.execLastActionResult(T.apply(w,i))}}}this.execActionIndex++,this.execNextAction()}},t.prototype.execLastActionResult=function(e){if(e){var t=this.lastActionResults.length;if(t)for(var n=0;t>n;n++)for(var r=this.lastActionResults[n],a=0,i=e.length;i>a;a++){var s=e[a];r.name==s.name?this.lastActionResults[n]=s:this.lastActionResults=this.lastActionResults.concat(s)}else this.lastActionResults=this.lastActionResults.concat(e)}},t}();e.ConditionBlock=t,__reflect(t.prototype,"ls.ConditionBlock")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e}();t.sceneWidth=0,t.sceneHeight=0,t.version=0,t.isHasJpg=!1,t.isHasPng=!1,t.openLog=!0,e.Config=t,__reflect(t.prototype,"ls.Config")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return t.execute=function(e){this.stage=e.stage,this.onLayerInit(e),this.onPreResourceLoad()},t.onLayerInit=function(t){e.GameUILayer.init(t.stage),e.GameUILayer.document=t},t.onPreResourceLoad=function(){var n=e.ResCache.configResouces.projects;
n&&(this.publish=!0),this.publish?t.loadConfig(n.children):RES.getResByUrl("resource/assets/projects.xml",function(e){t.loadConfig(e.children)},this,RES.ResourceItem.TYPE_XML)},t.loadConfig=function(n){var r=n;if(r){for(var a=0;a<r.length;a++){var i=r[a],s=i.localName,o=i.attributes;if("internal"===s){var l=i.children[0].text,c=JSON.parse(decodeURIComponent(l));e.internalData=c.internalComponents}}for(var a=0;a<r.length;a++){var i=r[a],s=i.localName,o=i.attributes;switch(s){case"sceneSize":e.Config.sceneWidth=+o.width,e.Config.sceneHeight=+o.height,e.Config.openLog=1==+o.openLog;break;case"info":if(t.baseUrl=o.baseUrl,e.Config.sceneInfo={layoutName:o.layoutName,layoutUrl:o.layoutUrl,eventsheetName:o.eventsheetName,eventsheetUrl:o.eventsheetUrl,baseUrl:t.baseUrl},this.publish)this.globalData=e.ResCache.configResouces.global,e.LayoutDecoder.globalInstances=e.LayoutDecoder.decodeInstances(this.globalData),e.Config.sceneInfo.layoutData=e.ResCache.configResouces[e.Config.sceneInfo.layoutName],e.Config.sceneInfo.eventsheetData=e.ResCache.configResouces[e.Config.sceneInfo.eventsheetName],e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName);else{var h=this;h.onGlobalConfigLoad(e.Config.sceneInfo.baseUrl+"global.xml",function(){RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.layoutUrl,function(t){e.Config.sceneInfo.layoutData=t,RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.eventsheetUrl,function(t){e.Config.sceneInfo.eventsheetData=t,e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)},this)},e.Config.sceneInfo)},[e.Config.sceneInfo.layoutName])}break;case"version":e.Config.version=+i.text}}}},t.onGlobalConfigLoad=function(t,n,r){void 0===n&&(n=null),void 0===r&&(r=null),RES.getResByUrl(t,function(t){this.globalData=t,e.LayoutDecoder.globalInstances=e.LayoutDecoder.decodeInstances(this.globalData),null!=n&&n.apply(null,r)},this,RES.ResourceItem.TYPE_XML)},t.onConfigLoad=function(t){e.Config.sceneInfo.layoutName=t,e.Config.sceneInfo.layoutUrl=t+".xml",this.publish?(e.Config.sceneInfo.layoutData=e.ResCache.configResouces[e.Config.sceneInfo.layoutName],e.Config.sceneInfo.eventsheetName=e.Config.sceneInfo.layoutData.attributes.eventSheet,e.Config.sceneInfo.eventsheetData=e.ResCache.configResouces[e.Config.sceneInfo.layoutData.attributes.eventSheet],e.Config.sceneInfo.eventsheetUrl=e.Config.sceneInfo.layoutData.attributes.eventSheet+".xml",e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)):RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.layoutUrl,function(t){e.Config.sceneInfo.layoutData=t,e.Config.sceneInfo.eventsheetName=t.attributes.eventSheet,e.Config.sceneInfo.eventsheetUrl=e.Config.sceneInfo.eventsheetName+".xml",RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.eventsheetUrl,function(t){e.Config.sceneInfo.eventsheetData=t,e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)},this)},this)},t}();t.publish=!1,e.StartUp=t,__reflect(t.prototype,"ls.StartUp")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Event);t.KEY_DOWN="keyDown",t.KEY_UP="keyUp",e.KeyboardEvent=t,__reflect(t.prototype,"ls.KeyboardEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnForEachArrayElementEvent=t,__reflect(t.prototype,"ls.OnForEachArrayElementEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(t,n,r,a,i){void 0===r&&(r=null),void 0===a&&(a=!1),void 0===i&&(i=!1);var s=e.call(this,t,a,i)||this;return s.triggerTargets=[],s.triggerCondition=n,s.triggerData=r,s}return __extends(t,e),t}(egret.Event);t.TRIGGER="TRIGGER",e.TriggerEvent=t,__reflect(t.prototype,"ls.TriggerEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e}();e.EventSheetVo=t,__reflect(t.prototype,"ls.EventSheetVo");var n=function(){function e(){}return e}();e.FamilyVo=n,__reflect(n.prototype,"ls.FamilyVo");var r=function(){function e(){}return e}();e.VariableVo=r,__reflect(r.prototype,"ls.VariableVo");var a=function(){function e(){}return e}();e.CollisionDataVo=a,__reflect(a.prototype,"ls.CollisionDataVo");var i=function(){function e(){this.enemyNames=[]}return e}();__reflect(i.prototype,"CollisionSearchVo");var s=function(){function a(){}return a.saveEventSheetData=function(n){var r=e.Config.sceneInfo.eventsheetData;this.eventsheetVo=new t,this.eventsheetVo.eventSheetName=n,this.eventsheetVo.nextEventSheetName=r.attributes.next,this.eventsheetVo.prevEventSheetName=r.attributes.previous,this.eventsheetVo.layoutName=r.attributes.layout;var a=r.attributes.version;this.eventsheetVo.version=a?a:"1.1.1",this.eventSheets[n]=this.eventsheetVo},a.start=function(t){e.assert(null==t||""==t,t+" can not null!"),this.saveEventSheetData(t);var n=e.Config.sceneInfo.eventsheetData;e.assert(null==n,"can not find "+t),this.curSceneInstancesData=[],this.curSceneEventsData=[],this.curSceneAiObjects=[],this.curSceneAiObjectsHash={},this.curSceneEvents=[];e.World.getInstance().objectList;this.currentEventSheetName=t;var r=n.children;if(void 0!==r){for(var a=0,i=r.length;i>a;a++){var s=r[a],o=s.attributes.type;switch(o){case"instance":e.LayoutDecoder.curSceneInstances[s.attributes.UID]&&this.curSceneInstancesData.push(s);break;case"family":var l=this.decodeFamily(s);this.curFamilys[l.name]=l;break;case"event":this.curSceneEventsData.push(s);break;case"variable":var c=this.decodeVaraible(s);if(c.initValue=decodeURIComponent(c.initValue),void 0==e.AISystem.instance[c.name]){switch(c.variableType){case"number":e.AISystem.instance[c.name]=+e.eval_e(c.initValue);break;case"string":e.AISystem.instance[c.name]=c.initValue+"";break;case"any":e.AISystem.instance[c.name]=c.initValue;break;case"boolean":e.AISystem.instance[c.name]=Boolean(e.eval_e(c.initValue))}void 0==e.AISystem.instance.globalVariables&&(e.AISystem.instance.globalVariables={}),e.AISystem.instance.globalVariables[c.name]=e.AISystem.instance[c.name]}}}this.decode()}},a.decode=function(){this.decodePropertys(),this.decodeEvents(),this.decodeFamilyBehaviors(),this.onBehaviorsCreate(),this.onInstancesCreate(),e.AISystem.instance.sendSceneInitComplete(),this.onRenderUpdate(),e.GameUILayer.stage.addEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)},a.decodeFamilyBehaviors=function(){var t=this.curFamilys,n=e.World.getInstance();for(var r in t)for(var a=t[r],i=a.insts,s=0,o=i.length;o>s;s++)for(var l=i[s],c=l.name,h=n.objectHash[c],u=0,p=h.length;p>u;u++)for(var f=h[u],v=0,_=a.behaviors.length;_>v;v++){var y=a.behaviors[v],d=y.clone();f.addBehavior(d),d.onCreate(),d.isCreated=!0}},a.onBehaviorsCreate=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var r=t[n];if(r){var a=r.behaviors;if(a)for(var i=0;i<a.length;i++){var s=a[i];s.onCreate(),s.isCreated=!0}}}},a.decodePropertys=function(){for(var t=0,n=this.curSceneInstancesData.length;n>t;t++){var r=this.curSceneInstancesData[t],a=(r.attributes.type,+r.attributes.UID),i=e.LayoutDecoder.curSceneInstances[a];if(null!=i){this.curSceneAiObjectsHash[i.name]=i,this.curSceneAiObjects.push(i);var s=r.children;if(s)for(var o=s.length,l=0;o>l;l++){var c=s[l];this.decodeInstancePropertie(c,i)}}else e.assert(!0,"EventSheetDecoder UID:"+a+" instance is null!")}},a.decodeFamily=function(t){var r=t.attributes.UID,a=""==r?[]:r.split(","),i=new n;if(i.name=t.attributes.target,i.UIDs=[],i.insts=[],a&&a.length)for(var s=0;s<a.length;s++)i.UIDs[s]=parseFloat(a[s]),i.insts[s]=e.LayoutDecoder.curSceneInstances[i.UIDs[s]];i.behaviors=[],i.variables=[];for(var o=t.children,s=0;s<o.length;s++){var l=o[s];switch(l.attributes.name){case"behaviors":for(var c=l.children,h=0;h<c.length;h++){var u=this.decodeBehavior(c[h]);i.behaviors[h]=u}break;case"variables":for(var p=l.children,f=0;f<p.length;f++){var v=this.decodeVaraible(p[f]);i.variables[f]=v}}}if(i.insts&&i.variables)for(var s=0;s<i.insts.length;s++)for(var _=i.insts[s],y=0;y<i.variables.length;y++){var d=i.variables[y];switch(d.initValue=decodeURIComponent(d.initValue),d.variableType){case"number":_[d.name]=+e.eval_e(d.initValue);break;case"string":_[d.name]=d.initValue;break;case"any":_[d.name]=d.initValue;break;case"boolean":_[d.name]=Boolean(e.eval_e(d.initValue))}}return i},a.decodeVaraible=function(e){var t=new r;return t.initValue=decodeURIComponent(e.attributes.initValue),t.variableType=e.attributes.variableType,t.name=e.attributes.variableName,t},a.decodeEvents=function(){for(var e=0;e<this.curSceneEventsData.length;e++){var t=this.curSceneEventsData[e],n=this.decodeEvent(t,e);n&&this.curSceneEvents.push(n)}},a.decodeEvent=function(t,n){var r=new e.AIEvent;r.index=n;var a=t.attributes.conditionRelationShip;a&&(r.conditionRelationShip=e.eval_e(a));var i=t.attributes.triggerOnceWhileTrue;i&&(r.triggerOnceWhileTrue=e.eval_e(i));var s=t.children;if(null!=s){for(var o,l=s.length,c=0,h=!1,u=0;l>u;u++)if("conditionBlock"===s[u].attributes.type){h=!0;break}if(h)for(var p=0,f=0;l>f;f++){var v,_=s[f],y=_.attributes.type;switch(y){case"conditionBlock":v=this.decodeConditionBlock(_.children,c,r),v.event=r,null==r.conditionBlocks&&(r.conditionBlocks=[]),r.conditionBlocks.push(v),0===c?o=v:(v.prevConditionBlock=o,o=v,v.prevConditionBlock.nextConditionBlock=v),c++;break;case"event":null==r.children&&(r.children=[]);var d=this.decodeEvent(_,p);d.parent=r,r.children.push(d),p++}}else{p=0;for(var g=[],f=0;l>f;f++){var _=s[f],y=_.attributes.type;switch(y){case"condition":case"action":g.push(_);break;case"event":null==r.children&&(r.children=[]);var d=this.decodeEvent(_,p);d.parent=r,r.children.push(d),p++}}v=this.decodeConditionBlock(g,0,r),v.event=r,null==r.conditionBlocks&&(r.conditionBlocks=[]),r.conditionBlocks.push(v),0===c?o=v:(v.prevConditionBlock=o,o=v,v.prevConditionBlock.nextConditionBlock=v),c++}return r}},a.decodeInstancePropertie=function(t,n){var r=t.attributes.type;switch(r){case"behavior":if(n.global)break;var a=this.decodeBehavior(t);n instanceof e.AIDisplayObject?n.addBehavior(a):e.assert(!0,n+"must instance of AIDisplayObject for have Behaviors");break;case"variable":var i=t.attributes.variableName,s=t.attributes.variableType,o=decodeURIComponent(t.attributes.initValue);switch(s){case"number":n.addVariable(i,+e.eval_e(o));break;case"string":n.addVariable(i,o+"");break;case"any":n.addVariable(i,o);break;case"boolean":n.addVariable(i,Boolean(e.eval_e(o)))}}},a.decodeBehavior=function(t){var n=t.attributes.behaviorType,r=e.getInstanceByPluginClassName(n);r.name=t.attributes.name;var a=t.children;if(a)for(var i=a.length,s=0;i>s;s++){var o=a[s],l=o.attributes.name,c=decodeURIComponent(o.attributes.value),h=o.attributes.valueDataType;switch(h){case"number":r[l]=+e.eval_e(c);break;case"string":r[l]=c+"";break;case"any":r[l]=c;break;case"boolean":r[l]=Boolean(e.eval_e(c))}}return r},a.decodeConditionBlock=function(t,n,r){var a=t;if(a){var i=new e.ConditionBlock;i.index=n,i.conditions=[],i.actions=[];for(var s,o,l,c,h=a.length,u=0,p=0,f=0;h>f;f++){var v=a[f],_=v.attributes.type;switch(_){case"condition":var y=this.decodeCondition(v,u,r);y.conditionBlock=i,y.event=r,void 0==y.callCondition&&(y.isFamily?e.assert(!0,"目标组没有"+y.callConditionName+"方法！！！"):e.assert(!0,"目标："+y.callTarget+"没有"+y.callConditionName+"方法！！！")),i.conditions.push(y),0===u?o=s=y:(y.prevCondition=o,o=y,y.prevCondition.nextCondition=y),u++;break;case"action":var d=this.decodeAction(v,p,r);d.conditionBlock=i,d.event=r,i.actions.push(d),0===p?c=l=d:(d.prevAction=c,c=d,d.prevAction.nextAction=d),p++}}return i}return null},a.decodeConditionProperties=function(t){var n=t.data,r=n.children;if(r)for(var a=r.length,i=0;a>i;i++){var s=r[i],o=s.attributes,l=o.name,c=o.value,h=o.variable?"true"===o.variable:!1,u=(o.valueDataType,o.isFamily?"true"===o.isFamily:!1);c=decodeURIComponent(c),t.isFamily=u,h&&(c='"'+c+'"'),t[l]=e.eval_e(c)}return t},a.decodeConditionFamilyProperties=function(e,t){var n=[],r=t.children;if(r)for(var a=r.length,i=0;a>i;i++){var s=r[i],o=s.attributes.isFamily?"true"===s.attributes.isFamily:!1;if(o)for(var l=s.attributes.value,c=this.curFamilys[l],h=c.insts,u=0;u<h.length;u++)-1==n.indexOf(h[u].name)&&n.push(h[u].name)}return n},a.decodeCondition=function(t,n,r){var a=t.attributes.target,i=t.attributes.behaviorName,s=e.getInstanceByPluginClassName(t.attributes.paramsClass),o=t.attributes.callName,l=!1;t.attributes.invert&&(l="true"===t.attributes.invert);var c=!1;t.attributes.loop&&(c="true"===t.attributes.loop);var h=new e.Condition;if(h.index=n,h.firstCondition=0==n?h:null,h.targetName=a,h.paramClassName=t.attributes.paramsClass,h.isInvert=l,h.paramsInstance=s,h.callConditionName=o,h.isFamily="true"==t.attributes.family,h.event=r,1===e.Version.compareVersion(this.eventsheetVo.version,"1.1.1")){var u=0;t.attributes.operatorType&&(u=+t.attributes.operatorType),h.operatorType=u}else h.operatorType=+!r.conditionRelationShip;if(s&&(s.data=t,h.isTrigger=Boolean(e.eval_e(t.attributes.isTrigger)),h.isTrigger&&this.triggerConditions.push(h)),"onCollisionWithOtherObject"==o&&this.decodeCollsionFamily(t,h,a),e.isSingleInst(a))h.callTarget=e.getInstanceByInstanceName(a),h.callCondition=h.callTarget[o];else{if(h.isFamily){var p=null,f=this.curFamilys[a],v=f.insts;void 0==v&&alert("当前场景中没有"+a+"的组！！！");for(var _=0;_<v.length;_++){var y=v[_],d=e.World.getInstance().objectHash[y.name][0];if(null!=i&&""!=i){if(d){for(var g,m=f.behaviors,b=0,x=m.length;x>b;b++){var E=m[b];if(E.name==i){g=E;break}}p=null==g?d:g}}else p=[],p.push(d)}h.callTarget=p,void 0==p[0]?h.callCondition=p[o]:h.callCondition=p[0][o]}else{var p=null;void 0==e.World.getInstance().objectHash[a]&&alert("当前场景中没有"+a+"实例对象！！！");var d=e.World.getInstance().objectHash[a][0];if(null!=i&&""!=i){if(d){for(var m=d.behaviors,b=0,x=m.length;x>b;b++){var E=m[b];if(E.name==i){p=E;break}}p=null==p?d:p}}else p=d;h.callTarget=p,h.callCondition=h.callTarget[o]}void 0===h.callCondition&&e.assert(!0,"条件目标:"+h.targetName+",没有调用的方法名："+o)}return h},a.decodeCollsionFamily=function(t,n,r){var a=t.children;if(a){var s=a[0].attributes.value,o=e.eval_e(a[0].attributes.isFamily),l=e.eval_e(e.getTransformationStr(s)),c=(this.decodeConditionFamilyProperties(n.paramsInstance,t),null);if(n.isFamily){var h=this.curFamilys[r];if(h)for(var u=0,p=h.insts.length;p>u;u++){var f=h.insts[u],v=f.name;if(void 0===this.collisionSearchs[v]?(c=new i,c.owerName=v,this.collisionSearchs[v]=c):c=this.collisionSearchs[v],o){var _=this.curFamilys[l];if(_)for(var y=0,d=_.insts.length;d>y;y++){var g=_.insts[y],m=g.name;-1==c.enemyNames.indexOf(m)&&c.enemyNames.push(m)}}else-1==c.enemyNames.indexOf(s)&&c.enemyNames.push(s)}}else if(void 0===this.collisionSearchs[r]?(c=new i,c.owerName=r,this.collisionSearchs[r]=c):c=this.collisionSearchs[r],o){var _=this.curFamilys[l];if(_)for(var y=0,d=_.insts.length;d>y;y++){var g=_.insts[y],m=g.name;-1==c.enemyNames.indexOf(m)&&c.enemyNames.push(m)}}else-1==c.enemyNames.indexOf(s)&&c.enemyNames.push(s)}},a.decodeAction=function(t,n,r){var a=t.attributes.target,i=t.attributes.behaviorName,s=t.attributes.callName,o=e.eval_e(t.attributes.persistent),l=e.eval_e(t.attributes.family),c=new e.Action;c.isBehaviorExecAction=void 0!==i,c.persistent=o;var h=null;if(l){null==h&&(h=[]);for(var u=this.curFamilys[a],p=0,f=u.insts.length;f>p;p++){var v=u.insts[p];h.push(v)}if(c.isBehaviorExecAction){var _=u.behaviors;if(_)for(var p=0,y=_.length;y>p;p++){var d=_[p];d.name==i&&(c.callTargetBehavior=d)}}}else{if(e.isSingleInst(a))h=e.getInstanceByInstanceName(a);else{for(var g=this.curSceneAiObjects,p=0,m=g.length;m>p;p++){var b=g[p];if(b.name==a){h=b;break}}null===h&&(h=e.eval_e(a))}if(c.isBehaviorExecAction&&h){var _=h.behaviors;if(_)for(var p=0,y=_.length;y>p;p++){var d=_[p];if(d.name==i){c.callTargetBehavior=d;break}}}}return c.index=n,c.targetName=a,c.isFamily=l,c.callTargets=h,c.paramData=t.children,c.callHanlderName=s,c},a.decodeActionParams=function(t){var n={},r=[],a=t.paramData,i=[],s=!1;if(a&&a.length)for(var o=0,l=a.length;l>o;o++){var c=a[o],h=c.attributes,u=(h.valueDataType,h.name,decodeURIComponent(h.value)),p=h.variable?"true"===h.variable:!1,f=h.isFamily?"true"===h.isFamily:!1;f&&(s=!0),p&&(u='"'+u+'"');var v=e.eval_e(u);i[o]=f,r.push(v)}return n.params=r,n.isFamilys=i,n.hasFamily=s,n},a.tick=function(){return this._tick},a.eventsheetRender=function(t){var n=e.AISystem.instance,r=egret.getTimer();0!==this.lastTime&&(this._tick=r-this.lastTime,this._tick<0&&(this._tick=0),this.dt1=this._tick/1e3,this.dt1>.5?this.dt1=0:this.dt1>1/n.minimumFramerate&&(this.dt1=1/n.minimumFramerate)),this.lastTime=r,this.dt=this.dt1*this.timeScale,this.renderEvents(),this.renderBehaviors(),e.World.getInstance().sceneCamera.render(),this.renderCamera(),null!=this.onEventSheetTick&&this.onEventSheetTick(),this.onRenderUpdate(),this.checkCollistions()},a.onRenderUpdate=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var r=t[n];r instanceof e.AIDisplayObject&&(r.onTick(),r.renderUpdate())}},a.renderCamera=function(){e.World.getInstance().render()},a.onInstancesCreate=function(){for(var t in e.LayoutDecoder.curSceneInstances){var n=e.LayoutDecoder.curSceneInstances[t];n.onCreate()}for(var r in e.LayoutDecoder.noSceneInstances){var a=e.LayoutDecoder.noSceneInstances[r];a&&a.onCreate&&a.onCreate()}},a.renderBehaviors=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var r=t[n],a=r.behaviors;if(a)for(var i=0,s=a.length;s>i;i++){var o=a[i];if(o.enabled&&o.inst){var l=egret.getQualifiedClassName(o);"ls.ScrollToBehavior"!=l&&o.tick()}}}for(var n=0;n<t.length;n++){var r=t[n],a=r.behaviors;if(a)for(var i=0,s=a.length;s>i;i++){var o=a[i];if(o.enabled&&o.inst){var l=egret.getQualifiedClassName(o);"ls.ScrollToBehavior"==l&&o.tick()}}}},a.renderEvents=function(){for(var t=e.AISystem.instance.disableDataEvents,n=0;n<this.curSceneEvents.length;n++)if(void 0==t[n+1]){var r=this.curSceneEvents[n];this.execEvent(r)}},a.execEvent=function(e,t){if(void 0===t&&(t=null),e.enabled){var n=!1;if(e.parent?e.parent.conditionBlocks[0].status&&(n=!0):n=!0,n){var r=e.conditionBlocks;this.execConditionBlock(r[0],t)}}},a.execConditionBlock=function(t,n){if(t){t.cs={},t.loopDatas=[],t.loopLayer=0,this.execNextCondition(t.conditions[0],t,n,function(){for(var n,r=[],i=0;i<t.conditions.length;i++){var s=t.conditions[i];n=0==i?s.currentStatus:1==s.operatorType?n||s.currentStatus:n&&s.currentStatus,s.triggerStatus=!1}if(t.status=n,n){t.event.triggerOnceWhileTrue&&(t.event.enabled=!1);var o={};for(var l in t.cs.instanceStatus){var c,h=t.cs.instanceStatus[l],u=h.instance,p=h.ccs,f=0;for(var v in p){var _=p[v],y=_.c;c=0==f?_.status:1==y.operatorType?c||_.status:c&&_.status,f++}c&&(r.push(u),o[u.u_id]=u)}if(r.length>0){for(var d=0,g=r.length;g>d;d++)e.lakeshoreInst()[r[d].name]=r[d];t.execActions(r);var m=t.event;if(m.children)for(var b=0;b<m.children.length;b++){var x=m.children[b];x&&(x.lastFilterTargets=o,a.execEvent(x))}}}});var r=t.nextConditionBlock;r&&this.execConditionBlock(r,n)}},a.execNextCondition=function(t,n,r,a){if(void 0===a&&(a=null),t){var i,s=t,o=s.targetName,l=s.isFamily,c=s.callTarget,h=s.callCondition,u=(s.callConditionName,s.isInvert),p=(s.paramClassName,s.paramsInstance),f=s.isTrigger;if(s.currentStatus=!1,n.cs.instanceStatus||(n.cs.instanceStatus={}),f){if(s.triggerStatus){var v=s.triggerfilters,_=!1;for(var y in v){var d,g=v[y];if(c instanceof e.BaseBehavior){var m;m=g.behaviors;for(var b=0;b<m.length;b++){var x=m[b];if(x.name==c.name){d=x;break}}}if(e.lakeshoreInst()[g.name]=g,this.decodeConditionProperties(p),s.triggerData)for(var E in s.triggerData)p.currentKeys[E]=s.triggerData[E];if(s.triggerChangeValue)for(var C in s.triggerChangeValue)p[C]=s.triggerChangeValue[C];var I=h.apply(d?d:g,[p]);I.status&&(_=!0);var O=I.instances.concat();if(G){for(var S={},T=0;T<O.length;T++){var w=O[T];G[w.u_id]&&(S[w.u_id]=w)}for(var D=0;D<O.length;D++){var w=O[D];for(var L in S){var A=S[L];if(w.name==A.name&&w.u_id!=A.u_id){O.splice(D,1),D--;break}}}for(var M in G){var P=G[M];n.cs.instanceStatus[P.u_id]||(n.cs.instanceStatus[P.u_id]={instance:P,ccs:{}}),n.cs.instanceStatus[P.u_id].ccs[s.index]={c:s,status:!0}}}for(var T=0,B=O.length;B>T;T++){var g=O[T];n.cs.instanceStatus[g.u_id]||(n.cs.instanceStatus[g.u_id]={instance:g,ccs:{}}),n.cs.instanceStatus[g.u_id].ccs[s.index]={c:s,status:I.status}}s.triggerStatus=!1,s.triggerfilters={},s.currentStatus=_}}}else{if(l){for(var R=this.curFamilys[o].insts,j=[],k=0,N=R.length;N>k;k++)for(var X=R[k].name,Y=e.World.getInstance().objectHash[X],V=0,U=Y.length;U>V;V++)j.push(Y[V]);i=j.concat()}else i=e.isSingleInst(o)?[e.getInstanceByInstanceName(o)]:e.World.getInstance().objectHash[o];var G=n.event.lastFilterTargets;if(G){var F={};i=i.concat();for(var H=0;H<i.length;H++){var w=i[H];G[w.u_id]&&(F[w.u_id]=w)}for(var D=0;D<i.length;D++){var w=i[D];for(var L in F){var A=F[L];if(w.name==A.name&&w.u_id!=A.u_id){i.splice(D,1),D--;break}}}for(var M in G){var P=G[M];n.cs.instanceStatus[P.u_id]||(n.cs.instanceStatus[P.u_id]={instance:P,ccs:{}}),n.cs.instanceStatus[P.u_id].ccs[s.index]={c:s,status:!0}}}for(var W=0;W<i.length;W++){var d,w=i[W];if(c instanceof e.BaseBehavior){var m;l?r&&r.familyVo&&(m=r.familyVo.behaviors):m=w.behaviors;for(var b=0;b<m.length;b++){var x=m[b];if(x.name==c.name){d=x;break}}}e.lakeshoreInst()[w.name]=w,this.decodeConditionProperties(p);var I=h.apply(d?d:w,[p]);if(I.status=u?!I.status:I.status,I.data&&(I.data instanceof e.ForEvent||I.data instanceof e.ForEachOrderEvent||I.data instanceof e.OnForEachArrayElementEvent)&&(n.loopDatas[n.loopLayer++]=I.data),n.cs.instanceStatus[w.u_id]||(n.cs.instanceStatus[w.u_id]={instance:w,ccs:{}}),n.cs.instanceStatus[w.u_id].ccs[s.index]={c:s,status:I.status},I.instances&&I.status)for(var q=0;q<I.instances.length;q++){var J=I.instances[q];n.cs.instanceStatus[J.u_id]||(n.cs.instanceStatus[J.u_id]={instance:J,ccs:{}}),n.cs.instanceStatus[J.u_id].ccs[s.index]={c:s,status:!0}}I.status&&(s.currentStatus=I.status)}}if(n.checkall){var z=t.nextCondition;z?this.execNextCondition(z,n,r,a):a&&a()}else if(s.currentStatus){var z=t.nextCondition;z?this.execNextCondition(z,n,r,a):a&&a()}else a&&a()}},a.checkCollistions=function(){var t=e.World.getInstance(),n=t.objectList,r={};for(var a in this.collisionSearchs){var i=this.collisionSearchs[a],s=t.objectHash[i.owerName];for(var o in s){var l=s[o];if(l.container.stage&&!l.isDead&&l.collision)for(var c=0;c<i.enemyNames.length;c++){var h=i.enemyNames[c],u=t.objectHash[h];for(var p in u){var f=u[p];if(f.container.stage&&f.collision&&!f.isDead){var v=e.Collision.checkCollision(l,f);v&&(null==r[l.u_id]&&(r[l.u_id]=[l,f]),null==r[f.u_id]&&(r[f.u_id]=[f,l]))}}}}}for(var _={},y=0;y<n.length;y++)if(n[y]instanceof e.AIDisplayObject){var d=n[y],g=r[d.u_id];if(null!=g){var m=g[1],b=0;null==_[d.u_id]&&(b++,_[d.u_id]=d),null==_[m.u_id]&&(b++,_[m.u_id]=m),2!=b&&d.setIsColliding(!0,m)}else d.setIsColliding(!1,null)}},a.execScenePauseOrPlay=function(t){0==t?(this.run=!1,e.GameUILayer.stage.removeEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)):(this.run=!0,e.GameUILayer.stage.addEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this))},a.destory=function(){this.curSceneInstancesData=[],this.curSceneEventsData=[],this.curSceneAiObjects=[],this.curSceneAiObjectsHash={},this.curSceneEvents=[],this.triggerConditions=[],this.curFamilys={},e.AISystem.instance.disableDataEvents={},e.GameUILayer.stage.removeEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)},a}();s.curSceneInstancesData=[],s.curSceneEventsData=[],s.curSceneAiObjects=[],s.curSceneAiObjectsHash={},s.curSceneEvents=[],s.curFamilys={},s.eventSheets={},s.collisionSearchs={},s.lastTime=0,s._tick=60,s.testShape=new egret.Sprite,s.dt=0,s.dt1=0,s.timeScale=1,s.triggerConditions=[],s.run=!0,e.EventSheetDecoder=s,__reflect(s.prototype,"ls.EventSheetDecoder")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.updateCamera=!0,t}return __extends(t,e),t.prototype.lookAtPoint=function(e){this.oldX!=e.x&&(this.oldX=e.x,this.updateCamera=!0,this.scrollX=e.x),this.oldY!=e.y&&(this.oldY=e.y,this.updateCamera=!0,this.scrollY=e.y)},t.prototype.lookAt=function(e,t){this.oldX!=e&&(this.oldX=e,this.updateCamera=!0,this.scrollX=e),this.oldY!=t&&(this.oldY=t,this.updateCamera=!0,this.scrollY=t)},t.prototype.lookAtX=function(e){this.oldX!=e&&(this.oldX=e,this.scrollX=e,this.updateCamera=!0)},t.prototype.lookAtY=function(e){this.oldY!=e&&(this.oldY=e,this.scrollY=e,this.updateCamera=!0)},t.prototype.add=function(e,t){this.isSet||(this.x-=e,this.y-=t,this.isSet=!0)},t}(egret.Sprite);e.Layer=t,__reflect(t.prototype,"ls.Layer")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return t.clearLayers=function(){this.layers={},e.GameUILayer.renderContainer.removeChildren()},t.getLayerByIndex=function(t,n){if(void 0===this.layers[n]){var r=new e.Layer;r.layerIndex=n,r.scrollX=e.GameUILayer.stage.stageWidth/2,r.scrollY=e.GameUILayer.stage.stageHeight/2,this.layers[n]=r;for(var a=e.GameUILayer.renderContainer,i=0,s=a.numChildren,o=0;s>o;o++){var l=a.getChildAt(o),c=l.layerIndex;if(!(n>c))break;i++}var h=e.LayoutDecoder.layers[n];void 0===h&&(h=new e.LayerVo,h.index=n,h.parallaxX=t.parallaxX,h.parallaxY=t.parallaxY,h.layerAlpha=1,h.layerVisible=!0,h.layerScaleX=100,h.layerScaleY=100,h.cacheAsBitmap=!1,e.LayoutDecoder.layers[n]=h),r.scaleX=h.layerScaleX/100,r.scaleY=h.layerScaleY/100,r.alpha=h.layerAlpha,r.visible=h.layerVisible,r.cacheAsBitmap=h.cacheAsBitmap,e.GameUILayer.renderContainer.addChildAt(r,i)}return this.layers[n]},t.getIndexByLayer=function(e){return e?e.layerIndex:-1},t.getLayer=function(e){return this.layers[e]},t}();t.layers={},e.LayerManager=t,__reflect(t.prototype,"ls.LayerManager")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e}();e.LayerVo=t,__reflect(t.prototype,"ls.LayerVo")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e}();e.Layout=t,__reflect(t.prototype,"ls.Layout");var n=function(){function n(){}return n.getTexture=function(e){for(var t in this.spriteSheets){var n=this.spriteSheets[t],r=n.getTexture(e);if(void 0!=r)return r}return null},n.saveLayout=function(n){var r=e.Config.sceneInfo.layoutData,a=new t;a.layoutName=n,a.nextLayoutName=r.attributes.next,a.prevLayoutName=r.attributes.previous,a.eventSheetName=r.attributes.eventSheet;var i=r.attributes.version;a.version=i?i:"1.1.1",this.layouts[n]=a,this.layoutVo=a},n.decodeExpressions=function(){if(this.layoutVo.eventSheetName){var t=e[this.layoutVo.layoutName];if(void 0!==t){var n=t();e.EventSheetDecoder.expressionObject={};for(var r in n){var a=decodeURIComponent(r);a=a.replace(/^['\"]{1}(.*)['\"]{1}$/,"$1"),e.EventSheetDecoder.expressionObject[a]=n[r]}}}},n.start=function(t){e.assert(null==t||""==t,"layout canot null!");var r=e.Config.sceneInfo.layoutData;e.assert(null==r,"can not find"+t);var a=r.attributes.sceneSize.split(",");this.sceneWidth=+a[0],this.sceneHeight=+a[1],this.currentLayoutName=t,this.saveLayout(t),this.decodeExpressions();var i=r.children;if(i){for(var s=[],o=0,l=i.length;l>o;o++){var c=i[o];if("layer"!=c.localName){var h=this.decodeInstance(c);if(h&&void 0!==h.index){var u=c.attributes.index?+c.attributes.index:o;h.index=u,s.push(h)}}else if(null==this.layers[+c.attributes.index]){var p=this.decodeLayers(c);this.layers[p.index]=p}}s=s.concat(n.globalInstances),s.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0});for(var o=0;o<s.length;o++){var h=s[o];e.World.getInstance().addChild(h)}}if(e.internalData)for(var o=0;o<e.internalData.length;o++){var f=e.internalData[o].name,v=e.getInstanceByPluginClassName(f,!0);v&&(v.initialize&&v.initialize(),this.noSceneInstances[f]=v)}for(var _ in this.curSceneInstances)e.registerObject(this.curSceneInstances[_].name,this.curSceneInstances[_])},n.decodeInstances=function(e){var t=[];if(e){var n=e.children;if(n)for(var r=0;r<n.length;r++){var a=n[r];if("layer"==a.localName){if(null==this.layers[+a.attributes.index]){var i=this.decodeLayers(a);this.layers[i.index]=i}}else{var s=this.decodeInstance(a);s&&void 0!==s.index&&(s.index=+a.attributes.index),s&&t.push(s)}}}return t},n.decodeLayers=function(t){var n=new e.LayerVo;return n.index=+t.attributes.index,n.parallaxX=+t.attributes.parallaxX,n.parallaxY=+t.attributes.parallaxY,n.layerAlpha=+t.attributes.layerAlpha,n.layerVisible="false"!=t.attributes.index,n.layerScaleX=+t.attributes.layerScaleX,n.layerScaleY=+t.attributes.layerScaleY,n.cacheAsBitmap="true"==t.attributes.cacheAsBitmap,n},n.decodeInstance=function(t){if("spritesheets"!=t.localName){var n=+t.attributes.UID,r=t.attributes.plugin,a=t.attributes.name;if(e.isInternal(a))return null;var i=this.curSceneInstances[n];if(void 0!=i)return i;if(i=e.getInstanceByPluginClassName(r),i.isModel=!0,i.name=a,i.id=n,i.parallaxX=+t.attributes.parallaxX,i.parallaxY=+t.attributes.parallaxY,null!=t.children){null==this.instanceNames[a]&&(this.instanceNames[a]=a);for(var s,o=!1,l={},c=0,h=t.children.length;h>c;c++){var u=t.children[c],p=u.attributes.name,f=u.attributes.value,v=u.attributes.valueDataType;switch(p){case"layer":o=!0,i[p]=+f;break;case"actions":i.setData(u.children);break;case"behaviors":s=u;break;default:switch(v){case"number":l[p]=+f;break;case"string":l[p]=decodeURIComponent(f),"collisionData"==p&&(i.collisionVectorData=this.decodeCollision(i,l[p]),i.collisionSourceData=decodeURIComponent(u.attributes.sourceValue),i.collisionSourceVectorData=this.decodeCollision(i,i.collisionSourceData));break;case"boolean":l[p]=e.eval_e(f);break;case"any":l[p]=e.eval_e(decodeURIComponent(f))}}}l.hasOwnProperty("width")&&(i.width=l.width),l.hasOwnProperty("height")&&(i.height=l.height);for(var _ in l)i[_]=l[_];return s&&this.decodeGlobalBehaviors(i,s),o||(i.layer=0),i&&i.initialize(),null==this.curSceneInstances[n]&&(this.curSceneInstances[n]=i),i}}},n.decodeCollision=function(t,n){var r;
if(t&&n)if(""==n)t.collisionType-1;else{var a=n.split("/n");if(2==a.length)switch(t.collisionType=+a[0],t.collisionType){case 0:r=[];var i=a[1].indexOf("_");if(-1!=i)for(var s=a[1].split("_"),o=0;o<s.length;o++){for(var l=s[o],c=l.split(","),h=[],u=0;u<c.length;u++){var p=c[u].split("|"),f=new e.Vector2D(+p[0],+p[1]);h[u]=f}r[o]=h}else{for(var c=a[1].split(","),h=[],o=0;o<c.length;o++){var p=c[o].split("|"),f=new e.Vector2D(+p[0],+p[1]);h[o]=f}r[0]=h}break;case 1:var v=a[1].split("|"),_=new e.Circle;_.center=new e.Vector2D(+v[0],+v[1]),_.radius=+v[2],r=_;break;case 2:var y=a[1].split("|");r=new e.Vector2D(+y[0],+y[1])}}return r},n.decodeGlobalBehaviors=function(t,n){if(t&&n&&t.global){var r=n.children;if(r)for(var a=0;a<r.length;a++){var i=r[a],s=e.EventSheetDecoder.decodeBehavior(i);t instanceof e.AIDisplayObject?t.addBehavior(s):e.assert(!0,t+"must instance of AIDisplayObject for have Behaviors")}}},n.destory=function(){this.instanceNames={},this.layers={}},n}();n.curSceneInstances={},n.noSceneInstances={},n.instanceNames={},n.layouts={},n.spriteSheets={},n.spriteSheetDatas={},n.globalInstances=[],n.layers={},e.LayoutDecoder=n,__reflect(n.prototype,"ls.LayoutDecoder")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return t.log=function(t){if(e.Config.openLog){if(null==this.logText){var n=e.GameUILayer.testContainer;n.graphics.clear(),n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,250,250),n.graphics.endFill(),this.logText=new egret.TextField,this.logText.width=250,this.logText.height=250,this.logText.size=14,this.logText.lineSpacing=6,this.logText.fontFamily="宋体",this.logText.textColor=49664,this.logText.x=5,this.logText.y=5,n.addChild(this.logText)}this.logCache.length>12&&this.logCache.shift(),t=void 0==t?"":t,this.logCache.push(t);for(var r="",a=0;a<this.logCache.length;a++)r+=this.logCache[a]+"\n";this.logText.text=r,this.logText.scrollV=this.logText.maxScrollV-12<0?0:this.logText.maxScrollV-12}},t}();t.logCache=[],e.Log=t,__reflect(t.prototype,"ls.Log")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e}();t.configResouces={},t.componentResources={},e.ResCache=t,__reflect(t.prototype,"ls.ResCache")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.init=function(e){e&&(this.stage=e,null==this.renderContainer&&(this.renderContainer=new egret.Sprite,this.renderContainer.name="renderContainer",e.addChild(this.renderContainer)),null==this.debugContainer&&(this.debugContainer=new egret.Sprite,this.debugContainer.name="debugContainer",e.addChild(this.debugContainer)),null==this.testContainer&&(this.testContainer=new egret.Sprite,this.testContainer.name="testContainer",e.addChild(this.testContainer)),null==this.preContainer&&(this.preContainer=new egret.Sprite,this.preContainer.name="preContainer",e.addChild(this.preContainer)),null==this.loadingContainer&&(this.loadingContainer=new egret.Sprite,this.loadingContainer.name="loadingContainer",e.addChild(this.loadingContainer)),null==this.drawContainer&&(this.drawContainer=new egret.Sprite,this.drawContainer.name="drawContainer",e.addChild(this.drawContainer)),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onStageTouchEvent,this)),window.document&&window.document.getElementsByClassName&&(window.document.getElementsByClassName("egret-player")[0].style.cursor="default"),window.addEventListener&&((180===window.orientation||0===window.orientation)&&(t.orientation=1),(90===window.orientation||-90===window.orientation)&&(t.orientation=0),window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){(180===window.orientation||0===window.orientation)&&(t.orientation=1),(90===window.orientation||-90===window.orientation)&&(t.orientation=0)},!1))},t.onStageTouchEvent=function(e){this.touchX=e.stageX,this.touchY=e.stageY},t}(egret.DisplayObjectContainer);t.touchX=0,t.touchY=0,t.orientation=0,e.GameUILayer=t,__reflect(t.prototype,"ls.GameUILayer")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(t){this.oldSceneX=0,this.oldSceneY=0,this.newSceneX=0,this.newSceneY=0,this.updateCamera=!1,this.fov=250,this.scene=t,this._scrollX=e.GameUILayer.stage.stageWidth>>1,this._scrollY=e.GameUILayer.stage.stageHeight>>1,this.otherLayers=[]}return t.prototype.resetCamera=function(){e.GameUILayer.renderContainer.x=e.GameUILayer.renderContainer.y=0,this.oldSceneX=this.oldSceneY=0,this.newSceneX=this.newSceneY=0},t.prototype.lookAtPoint=function(e){this.pos!=e&&(this.pos=e,this._scrollX=this.pos.x,this._scrollY=this.pos.y,this.updateCamera=!0)},t.prototype.lookAtX=function(e){this._scrollX!=e&&(this.updateCamera=!0,this._scrollX=e)},t.prototype.lookAtY=function(e){this._scrollY!=e&&(this.updateCamera=!0,this._scrollY=e)},t.prototype.lookAtChar=function(e){this.lookAtTarget=e,(this._scrollX!=this.lookAtTarget.x||this._scrollY!=this.lookAtTarget.y)&&(this.updateCamera=!0,this._scrollX=this.lookAtTarget.x,this._scrollY=this.lookAtTarget.y)},Object.defineProperty(t.prototype,"cameraLayer",{get:function(){return this._cameraLayer},set:function(t){this._cameraLayer=t,this.otherLayers=[];for(var n=0,r=e.GameUILayer.renderContainer.numChildren;r>n;n++){var a=e.GameUILayer.renderContainer.getChildAt(n);a!==this._cameraLayer&&this.otherLayers.push(a)}},enumerable:!0,configurable:!0}),t.prototype.render=function(){if(this.cameraLayer){if(!this.cameraLayer.updateCamera)return;this._cameraLayer=this.cameraLayer;var t=e.LayoutDecoder.sceneWidth,n=e.LayoutDecoder.sceneHeight,r=e.GameUILayer.stage.stageWidth,a=e.GameUILayer.stage.stageHeight,i=r>>1,s=a>>1,o=t-(r/this.cameraLayer.scaleX>>1),l=n-(a/this.cameraLayer.scaleY>>1);this.cameraLayer.scrollX<i/this.cameraLayer.scaleX&&(this.cameraLayer.scrollX=i/this.cameraLayer.scaleX),this.cameraLayer.scrollY<s/this.cameraLayer.scaleY&&(this.cameraLayer.scrollY=s/this.cameraLayer.scaleY),this.cameraLayer.scrollX>o&&(this.cameraLayer.scrollX=o),this.cameraLayer.scrollY>l&&(this.cameraLayer.scrollY=l),this.cameraLayer.tx=(this.cameraLayer.scrollX-i)*this.cameraLayer.parallaxX/100,this.cameraLayer.ty=(this.cameraLayer.scrollY-s)*this.cameraLayer.parallaxY/100,this.cameraLayer.dScrollX=isNaN(this.cameraLayer.oldScrollX)?this.cameraLayer.scrollX-i:this.cameraLayer.scrollX-this.cameraLayer.oldScrollX,this.cameraLayer.dScrollY=isNaN(this.cameraLayer.oldScrollY)?this.cameraLayer.scrollY-s:this.cameraLayer.scrollY-this.cameraLayer.oldScrollY,this.cameraLayer.oldScrollX=this.cameraLayer.scrollX,this.cameraLayer.oldScrollY=this.cameraLayer.scrollY,this.cameraLayer.x=-this.cameraLayer.tx*this.cameraLayer.scaleX,this.cameraLayer.y=-this.cameraLayer.ty*this.cameraLayer.scaleY,this.cameraLayer.x-=i*(this.cameraLayer.scaleX-1),this.cameraLayer.y-=s*(this.cameraLayer.scaleY-1),this.cameraLayer.x=this.cameraLayer.x>>0,this.cameraLayer.y=this.cameraLayer.y>>0;for(var c=0,h=this.otherLayers.length;h>c;c++){var u=this.otherLayers[c],p=this.cameraLayer.tx,f=this.cameraLayer.ty,v=-this.cameraLayer.tx*u.parallaxX/this.cameraLayer.parallaxX,_=-this.cameraLayer.ty*u.parallaxY/this.cameraLayer.parallaxY,y=i*(u.scaleX-1)-this.cameraLayer.tx,d=s*(u.scaleY-1)-this.cameraLayer.ty;u.update=!1,u.tmpTx!=p&&(u.tmpTx=p,u.update=!0),u.tmpTy!=f&&(u.tmpTy=f,u.update=!0),u.tmpX1!=v&&(u.tmpX1=v,u.update=!0),u.tmpY1!=_&&(u.tmpY1=_,u.update=!0),u.tmpX2!=y&&(u.tmpX2=y,u.update=!0),u.tmpY2!=d&&(u.tmpY2=d,u.update=!0),u.update&&(u.anchorOffsetX=this.cameraLayer.tx,u.anchorOffsetY=this.cameraLayer.ty,u.x=u.tmpX1-u.tmpX2,u.y=u.tmpY1-u.tmpY2,u.anchorOffsetX=u.anchorOffsetX>>0,u.anchorOffsetY=u.anchorOffsetY>>0,u.x=u.x>>0,u.y=u.y>>0)}this.cameraLayer.updateCamera=!1}},t}();e.SceneCamera=t,__reflect(t.prototype,"ls.SceneCamera")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){if(this._objectList=[],this._objectHash={},this._updateCamera=!0,t._instance)throw new Error(this.constructor+"为单例！");t._instance=this,this._sceneCamera=new e.SceneCamera(this)}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},Object.defineProperty(t.prototype,"sceneCamera",{get:function(){return this._sceneCamera},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectList",{get:function(){return this._objectList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectHash",{get:function(){return this._objectHash},enumerable:!0,configurable:!0}),t.prototype.scrollToTarget=function(e){this._sceneCamera.lookAtChar(e)},t.prototype.scrollToXY=function(e,t){this._sceneCamera.lookAtPoint(new egret.Point(e,t))},t.prototype.scrollToX=function(e){this._sceneCamera.lookAtX(e)},t.prototype.scrollToY=function(e){this._sceneCamera.lookAtY(e)},Object.defineProperty(t.prototype,"cameraLayer",{get:function(){return this._sceneCamera.cameraLayer},enumerable:!0,configurable:!0}),t.prototype.render=function(){},t.prototype.getChildByUID=function(e){void 0===e&&(e=0);for(var t=0,n=this._objectList.length;n>t;t++){var r=this._objectList[t];if(r.id==e)return r}return null},t.prototype.getChildByName=function(e){var t=[];if(null==e||""==e)return t;for(var n=0,r=this._objectList.length;r>n;n++){var a=this._objectList[n];a.name==e&&t.push(a)}return t},t.prototype.addChildLayerAt=function(t,n,r){var a=t.container;if(void 0!=a&&null!=a){var i=e.LayerManager.getLayer(n);i?i.addChildAt(a,r):(i=e.LayerManager.getLayerByIndex(t,n),i.parallaxX=t.parallaxX,i.parallaxY=t.parallaxY,i.addChild(a))}this._addChild(t)},t.prototype.addChild=function(t){var n=t.container;if(void 0!=n&&null!=n){var r=t.layer,a=e.LayerManager.getLayerByIndex(t,r);a.parallaxX=t.parallaxX,a.parallaxY=t.parallaxY,a.addChild(n)}this._addChild(t)},t.prototype._addChild=function(e){var t=e.name;this._objectHash.hasOwnProperty(t)||(this._objectHash[t]=[]);for(var n=-1,r=0;r<this._objectHash[t].length;r++){var a=this._objectHash[t][r];if(a.u_id==e.u_id){n=r;break}}-1==n?(this._objectHash[t].push(e),this._objectList.push(e)):this._objectHash[t][n]=e},t.prototype.removeChild=function(t){if(t){var n=this.objectList.indexOf(t);-1!=n&&this._objectList.splice(n,1);var r=t.container;if(r&&null!=r.parent&&r.parent.removeChild(r),this._objectHash.hasOwnProperty(t.name)){for(var a=this._objectHash[t.name],i=-1,s=0;s<a.length;s++){var o=a[s];if(o.u_id==t.u_id){i=s;break}}-1!=i&&a.splice(i,1)}t.id>=0&&delete e.LayoutDecoder.curSceneInstances[t.id],e.Trigger.removeTrigger(t)}},t.prototype.removeAllChildrens=function(){e.Trigger.removeAllTriggers();for(var t in this._objectHash){var n=this._objectHash[t];if(n)for(var r=n.length-1;r>=0;r--){var a=n[r];a.global||a.destoryOnChangeScene()}}},t.prototype.destory=function(){this._sceneCamera.lookAtPoint(new egret.Point(0,0)),null!=t.onWorldDestory&&t.onWorldDestory(),e.LayoutDecoder.destory(),e.EventSheetDecoder.destory(),this._sceneCamera.resetCamera(),this.removeAllChildrens(),e.LayerManager.clearLayers()},t}();t.renderFirst=!0,e.World=t,__reflect(t.prototype,"ls.World")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(ls){function assert(e,t){if(e){var n;try{throw Error()}catch(r){n=r.stack}var t="【ERROR】:"+t+"\n\nStack trace: \n"+n;console.error&&console.error(t),isWeixinLogin()&&alert(t)}}function registerObject(e,t){window[e]=t}function lakeshoreInst(){return window}function eval_e(exp){try{if("number"==typeof exp)return exp;if(void 0===exp)return;if(null===exp)return null;if(""===exp)return"";if("0"===exp)return 0;if("true"===exp||exp===!0)return!0;if("false"===exp||exp===!1)return!1;var numexp=+exp;if(!isNaN(numexp))return numexp;var expressionObject=ls.EventSheetDecoder.expressionObject;if(void 0===expressionObject)return eval(exp);var expressValue=expressionObject[exp];return void 0!=expressValue?expressValue():"string"==typeof exp&&"a"===exp?exp:eval(exp)}catch(exception){return exp}}function getloopIndex(e){return ls.loopIndex[e]}function fps(){return 1/dt()}function dt(){return ls.EventSheetDecoder.dt1}function objectcount(){return ls.World.getInstance().objectList.length}function stageWidth(){return ls.GameUILayer.stage.stageWidth}function stageHeight(){return ls.GameUILayer.stage.stageHeight}function sceneWidth(){return ls.LayoutDecoder.sceneWidth}function sceneHeight(){return ls.LayoutDecoder.sceneHeight}function iswebgl(){return"webgl"==egret.Capabilities.renderMode}function timeScale(){return 1}function time(){return egret.getTimer()-ls.oldtime}function log(e){e+="",e=e.split(",");for(var t=0;t<e.length;t++){var n=eval_e(e[t]);ls.Log.log(n)}}function isPc(){if(window.navigator){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,r=0;r<t.length;r++)if(e.indexOf(t[r])>0){n=!1;break}return n}return!1}function injectProp(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n=!0),!t)return!1;var r=!0;for(var a in t){var i=t[a];n&&"function"==typeof i||(e[a]=i)}return r}function getMiniSeconds(e){var t=/-/g,n=new Date(Date.parse(e.replace(t,"/")));return n.getTime()}function getRemainTimeStr(e,t,n){void 0===t&&(t=":"),void 0===n&&(n=!0);var r=this.getMiniSeconds(e),a=(new Date).getTime(),i=r-a;if(i>=0){var s=Math.round(i/1e3),o=Math.floor(s/3600),l=Math.floor((s-3600*o)/60),c=s-3600*o-60*l,h=10>o?"0"+o:o.toString(),u=10>l?"0"+l:l.toString(),p=10>c?"0"+c:c.toString();return h+t+u+t+p}return n?"00"+t+"00"+t+"00":""}function isInternal(e){if(void 0==ls.cacheInternal[e]){var t=!1;if(ls.internalData)for(var n=0;n<ls.internalData.length;n++){var r=ls.internalData[n];if(r.name==e){t=!0;break}}ls.cacheInternal[e]=t}return ls.cacheInternal[e]}function getPlugin(e){if(void 0==ls.cachePlugins[e]){var t="";if(ls.internalData)for(var n=0;n<ls.internalData.length;n++){var r=ls.internalData[n];if(r.name==e){t=r.plugin;break}}ls.cachePlugins[e]=t}return ls.cachePlugins[e]}function isSingleInst(e){return isInternal(e)}function getInstanceByInstanceName(e){var t,n;if(isSingleInst(e)){if(null==ls.singles[e]){if(n=egret.getDefinitionByName("ls."+getPlugin(e)),null==n)return void alert("name:"+e);n.name=e,t=null==n.instance?new n:n.instance,ls.singles[e]=t,registerObject(e,t)}else t=ls.singles[e];isInternal(e)&&(window[e]=t)}return t}function getInstanceByPluginClassName(e,t){void 0===t&&(t=!1);var n,r;if("Object"==e)return null;if(isSingleInst(e))if(null==ls.singles[e]){if(r=egret.getDefinitionByName("ls."+getPlugin(e)),null==r)return void(t||alert("name:"+e));r.name=e,n="System"==e?r.instance:new r,n.name=e,ls.singles[e]=n,registerObject(e,n)}else n=ls.singles[e];else{if(r=egret.getDefinitionByName("ls."+e),null==r)return t||alert("name:"+e),void(n=null);n=new r}return isInternal(e)&&(window[e]=n),n}function getTexture(e){if(e){var t,n=e;if(n){var r=ls.LayoutDecoder.spriteSheetDatas[n];if(r&&(t=r.texture),(void 0==t||null==t)&&(t=RES.getRes(n)),void 0!=t&&null!=t)return[t,r?r.offsetX:0,r?r.offsetY:0]}}return null}function getName(e){return e?e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")):""}function getTransformationStr(e){return e}function xmlToJson(e){var t={};if(1==e.nodeType)for(var n in e.attributes)t[n]=e.attributes[n];else 3==e.nodeType&&(t=e.name);if(e.children)for(var r=0;r<e.children.length;r++){var a=e.children[r],i=a.localName;if(i)if(void 0==t[i])t[i]=this.xmlToJson(a);else{if(void 0==t[i].length){var s=t[i];t[i]=[],t[i].push(s)}t[i].push(this.xmlToJson(a))}else t.text=a.text}return t}function round6dp(e){return Math.round(1e6*e)/1e6}function is_undefined(e){return"undefined"==typeof e}function is_number(e){return"number"==typeof e}function is_string(e){return"string"==typeof e}function isPot(e){return e>0&&0===(e-1&e)}function abs(e){return e=eval_e(e),Math.abs(e)}function acos(e){return e=eval_e(e),Math.acos(e)}function angle(e,t,n,r){return e=eval_e(e),t=eval_e(t),n=eval_e(n),r=eval_e(r),180*Math.atan2(r-t,n-e)/Math.PI}function asin(e){return e=eval_e(e),Math.asin(e)}function atan(e){return e=eval_e(e),Math.atan(e)}function atan2(e,t){return e=eval_e(e),t=eval_e(t),Math.atan2(e,t)}function ceil(e){return e=eval_e(e),Math.ceil(e)}function floor(e){return e=eval_e(e),Math.floor(e)}function sin(e){return e=eval_e(e),Math.sin(e)}function cos(e){return e=eval_e(e),Math.cos(e)}function sqrt(e){return e=eval_e(e),Math.sqrt(e)}function tan(e){return e=eval_e(e),Math.tan(e)}function cosp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),(e+t+(e-t)*Math.cos(n*Math.PI))/2}function distance(e,t,n,r){e=eval_e(e),t=eval_e(t),n=eval_e(n),r=eval_e(r);var a=e-n,i=t-r;return Math.sqrt(a*a+i*i)}function exp(e){return e=eval_e(e),Math.exp(e)}function pow(e,t){return e=eval_e(e),t=eval_e(t),Math.pow(e,t)}function getbit(e,t){return e=eval_e(e),t=eval_e(t),e=0|e,t=0|t,e&1<<t?1:0}function lerp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e+(t-e)*n}function unlerp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e==t?0:(n-e)/(t-e)}function log10(e){return e=eval_e(e),Math.log(e)/Math.LN10}function max(e,t){return e=eval_e(e),t=eval_e(t),Math.max(e,t)}function min(e,t){return e=eval_e(e),t=eval_e(t),Math.min(e,t)}function pi(){return Math.PI}function qarp(e,t,n,r){return e=eval_e(e),t=eval_e(t),n=eval_e(n),r=eval_e(r),lerp(lerp(e,t,r),lerp(t,n,r),r)}function round(e){return e=eval_e(e),Math.round(e)}function random(){return Math.random()}function togglebit(e,t){return e=eval_e(e),t=eval_e(t),e=0|e,t=0|t,e^1<<t}function float(e){return e=eval_e(e),+e}function int(e){return e=eval_e(e),parseInt(e)}function rgb(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),Math.max(Math.min(e,255),0)|Math.max(Math.min(t,255),0)<<8|Math.max(Math.min(n,255),0)<<16}function getRed(e){return e=eval_e(e),255&e}function getGreen(e){return e=eval_e(e),(65280&e)>>8}function getBlue(e){return e=eval_e(e),(16711680&e)>>16}function regexp_escape(e){return e=eval_e(e),e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function find(e,t){return e=eval_e(e),t=eval_e(t),e.search(new RegExp(regexp_escape(t),"i"))}function replace(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e.replace(new RegExp(regexp_escape(t),"gi"),n)}function left(e,t){return e=eval_e(e),t=eval_e(t),e.substr(e,t)}function right(e,t){return e=eval_e(e),e.substr(e.length-t)}function len(e){return void 0==e||null==e?0:(e=eval_e(e),e+="",e.length)}function toFixed(e,t){return e=eval_e(e),t=eval_e(t),parseFloat(parseFloat(e).toFixed(t))}function lowercase(e){return e=eval_e(e),e.toLowerCase()}function upppercase(e){return e=eval_e(e),e.toUpperCase()}function trim(e){return e=eval_e(e),e.trim()}function mid(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e.substr(t,n)}function newline(){return"\n"}function zeropad(e,t){e=eval_e(e),t=eval_e(t);var n=0>e?"-":"";0>e&&(e=-e);for(var r=t-e.toString().length,a=0;r>a;a++)n+="0";return n+e.toString()}function choose(){var e=Math.floor(Math.random()*(arguments.length-1));return arguments[e+1]}function getTime(){return(new Date).getTime()}function week(){return(new Date).getDay()}function year(){return(new Date).getFullYear()}function month(){return(new Date).getMonth()}function day(){return(new Date).getDate()}function hours(){return(new Date).getHours()}function minutes(){return(new Date).getMinutes()}function seconds(){return(new Date).getSeconds()}function minuteSeconds(){return(new Date).getMilliseconds()}function clamp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),t>e?t:e>n?n:e}function isWeixinLogin(){if(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase){var e=window.navigator.userAgent.toLowerCase(),t=e.match(/MicroMessenger/i);return t&&t.length>0&&"micromessenger"==t[0]}return!1}function compare(e,t,n){var r=eval_e(e),a=eval_e(n);switch(t){case OperationType.EQUAL_TO:return r==a;case OperationType.GREATER_OR_EQUAL:return r>=a;case OperationType.GREATER_THAN:return r>a;case OperationType.LESS_OR_EQUAL:return a>=r;case OperationType.LESS_THAN:return a>r;case OperationType.NOT_EQUAL_TO:return r!=a}return!1}ls.loopIndex={},ls.assert=assert,ls.registerObject=registerObject,ls.lakeshoreInst=lakeshoreInst,ls.eval_e=eval_e,ls.getloopIndex=getloopIndex,ls.fps=fps,ls.dt=dt,ls.objectcount=objectcount,ls.stageWidth=stageWidth,ls.stageHeight=stageHeight,ls.sceneWidth=sceneWidth,ls.sceneHeight=sceneHeight,ls.iswebgl=iswebgl,ls.timeScale=timeScale,ls.oldtime=egret.getTimer(),ls.time=time,ls.log=log,ls.isPc=isPc,ls.injectProp=injectProp,ls.getMiniSeconds=getMiniSeconds,ls.getRemainTimeStr=getRemainTimeStr,ls.internalData=[],ls.cacheInternal={},ls.cachePlugins={},ls.isInternal=isInternal,ls.getPlugin=getPlugin,ls.isSingleInst=isSingleInst,ls.singles={},ls.getInstanceByInstanceName=getInstanceByInstanceName,ls.getInstanceByPluginClassName=getInstanceByPluginClassName,ls.getTexture=getTexture,ls.getName=getName,ls.getTransformationStr=getTransformationStr,ls.xmlToJson=xmlToJson,ls.round6dp=round6dp,ls.is_undefined=is_undefined,ls.is_number=is_number,ls.is_string=is_string,ls.isPot=isPot,ls.abs=abs,ls.acos=acos,ls.angle=angle,ls.asin=asin,ls.atan=atan,ls.atan2=atan2,ls.ceil=ceil,ls.floor=floor,ls.sin=sin,ls.cos=cos,ls.sqrt=sqrt,ls.tan=tan,ls.cosp=cosp,ls.distance=distance,ls.exp=exp,ls.pow=pow,ls.getbit=getbit,ls.lerp=lerp,ls.unlerp=unlerp,ls.log10=log10,ls.max=max,ls.min=min,ls.pi=pi,ls.qarp=qarp,ls.round=round,ls.random=random,ls.togglebit=togglebit,ls["float"]=float,ls["int"]=int,ls.rgb=rgb,ls.getRed=getRed,ls.getGreen=getGreen,ls.getBlue=getBlue,ls.regexp_escape=regexp_escape,ls.find=find,ls.replace=replace,ls.left=left,ls.right=right,ls.len=len,ls.toFixed=toFixed,ls.lowercase=lowercase,ls.upppercase=upppercase,ls.trim=trim,ls.mid=mid,ls.newline=newline,ls.zeropad=zeropad,ls.choose=choose,ls.getTime=getTime,ls.week=week,ls.year=year,ls.month=month,ls.day=day,ls.hours=hours,ls.minutes=minutes,ls.seconds=seconds,ls.minuteSeconds=minuteSeconds,ls.clamp=clamp,ls.isWeixinLogin=isWeixinLogin;var OperationType=function(){function e(){}return e}();OperationType.EQUAL_TO="equalTo",OperationType.NOT_EQUAL_TO="notEqualTo",OperationType.LESS_THAN="lessThan",OperationType.LESS_OR_EQUAL="lessOrEqual",OperationType.GREATER_THAN="greaterThan",OperationType.GREATER_OR_EQUAL="greaterOrEqual",ls.OperationType=OperationType,__reflect(OperationType.prototype,"ls.OperationType");var InstanceVariablesType=function(){function e(){}return e}();InstanceVariablesType.TEXT="text",InstanceVariablesType.INT="int",InstanceVariablesType.NUMBER="Number",InstanceVariablesType.BOOLEAN="boolean",ls.InstanceVariablesType=InstanceVariablesType,__reflect(InstanceVariablesType.prototype,"ls.InstanceVariablesType"),ls.compare=compare}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e.compareVersion=function(e,t){var n=e.split("."),r=t.split("."),a=n[0]+"."+n[1];n[2]&&(a+=n[2]);var i=r[0]+"."+r[1];r[2]&&(i+=r[2]);var s=+a,o=+i;return s>o?1:s===o?0:-1},e}();t.version="1.2",e.Version=t,__reflect(t.prototype,"ls.Version")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._sourceWidth=0,e._sourceHeight=0,e._isResourceLoaded=!1,e.name="Sprite",e._bitmap=new egret.Bitmap,e.container.addChild(e._bitmap),e}return __extends(n,t),Object.defineProperty(n.prototype,"bitmapURL",{get:function(){return this._bitmapURL},enumerable:!0,configurable:!0}),n.prototype.initialize=function(){this.createBitmap(this.url)},n.prototype.createBitmap=function(t){if(t&&""!=t){this._bitmapURL=t;var n=this,r=e.getTexture(t);if(null!=r)var a=r[0];if(null!=a)this._bitmap.texture=a,this._sourceWidth=a.textureWidth,this._sourceHeight=a.textureHeight,this._bitmap.width=this.width,this._bitmap.height=this.height,this._bitmap.smoothing=!0,r&&(this._bitmap.x=r[1],this._bitmap.y=r[2]),this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,n.onResourceLoaded)),this.dispatchEvent(new egret.Event(egret.Event.COMPLETE));else{var i=function(t){t&&(n._bitmap.texture=t,n._sourceWidth=t.textureWidth,n._sourceHeight=t.textureHeight,n._bitmap.width=n.width,n._bitmap.height=n.height,n.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,n.onResourceLoaded)),n.dispatchEvent(new egret.Event(egret.Event.COMPLETE)))};RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)}}},n.prototype.loadImage=function(t){var n=e.eval_e(t);this.createBitmap(n)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width!=e&&(this._width=e,this.update=!0),this._bitmap&&this._bitmap.width!=e&&(this._bitmap.width=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height!=e&&(this._height=e,this.update=!0),this._bitmap&&this._bitmap.height!=e&&(this._bitmap.height=e)},enumerable:!0,configurable:!0}),n.prototype.beginFill=function(t,n){t=e.eval_e(t),n=e.eval_e(n),this.container.graphics.beginFill(t,n)},n.prototype.beginGadientFill=function(t,n,r,a,i){t=e.eval_e(t);var s=n.split(",");s.forEach(function(e,t,n){e=parseFloat(e)});var o=r.split(",");o.forEach(function(e,t,n){e=parseFloat(e)});var l=a.split(",");l.forEach(function(e,t,n){e=parseFloat(e)});var c=i.split(",");c.forEach(function(e,t,n){e=parseFloat(e)}),c.length>5&&e.assert(!0,"渐变填充矩阵数据长度不能大于5");var h=new egret.Matrix;h.createGradientBox(c[0],c[1],c[2],c[3],c[4]),this.container.graphics.beginGradientFill(t,s,o,l,h)},n.prototype.endFill=function(){this.container.graphics.endFill()},n.prototype.clear=function(){this.container.graphics.clear()},n.prototype.lineStyle=function(t,n,r,a,i,s,o){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),o=e.eval_e(o),this.container.graphics.lineStyle(t,n,r,a,i,s,o)},n.prototype.moveTo=function(t,n){t=e.eval_e(t),n=e.eval_e(n),this.container.graphics.moveTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY)},n.prototype.lineTo=function(t,n){t=e.eval_e(t),n=e.eval_e(n),this.container.graphics.lineTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY)},n.prototype.drawRect=function(t,n,r,a){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),this.container.graphics.drawRect(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,r,a)},n.prototype.drawCircle=function(t,n,r){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),this.container.graphics.drawCircle(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,r)},n.prototype.drawEllipse=function(t,n,r,a){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),this.container.graphics.drawEllipse(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,r,a)},n.prototype.drawRoundRect=function(t,n,r,a,i,s){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),this.container.graphics.drawRoundRect(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,r,a,i,s)},n.prototype.drawArc=function(t,n,r,a,i,s){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),this.container.graphics.drawArc(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,r,a,i,s)},n.prototype.curveTo=function(t,n,r,a,i,s){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),this.container.graphics.moveTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY),this.container.graphics.curveTo(r-this.x+this.anchorOffsetX,a-this.y+this.anchorOffsetY,i-this.x+this.anchorOffsetX,s-this.y+this.anchorOffsetY)},n.prototype.cubicCurveTo=function(t,n,r,a,i,s,o,l){t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.eval_e(a),i=e.eval_e(i),s=e.eval_e(s),o=e.eval_e(o),l=e.eval_e(l),this.container.graphics.moveTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY),this.container.graphics.cubicCurveTo(r-this.x+this.anchorOffsetX,a-this.y+this.anchorOffsetY,i-this.x+this.anchorOffsetX,s-this.y+this.anchorOffsetY,o-this.x+this.anchorOffsetX,l-this.y+this.anchorOffsetY)},n.prototype.onResourceLoaded=function(e){return{instances:[this],status:!0}},n.prototype.subtractFrom=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=r},n.prototype.saveToJSON=function(){var e=t.prototype.saveToJSON.call(this);return e.url=this.url,e},n.prototype.loadFromJSON=function(e){e&&(this.url=e.url,t.prototype.loadFromJSON.call(this,e))},n.prototype.clone=function(){var e=t.prototype.clone.call(this);return e.url=this.url,e},n}(e.AIDisplayObject);e.AISprite=t,__reflect(t.prototype,"ls.AISprite");var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.OnResourceLoadedEvent=n,__reflect(n.prototype,"ls.OnResourceLoadedEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(t){function n(){var e=t.call(this)||this;if(e._heading=0,e._lastUpdate=0,e._lastTime=0,e.SHAKE_THRESHOLD=1e3,e.isShakeble=!0,e.minimumFramerate=30,e.disableDataEvents={},e.lastRegex="",e.lastFlags="",e.loadStorages={},e.saveStorages={},null!=n._instance)throw new Error("AISystem 为单例！！！");return e.name="System",n._instance=e,e.onDevice(),e.onGetGeolocation(),e.onDeviceMotion(),e}return __extends(n,t),n.prototype.onDevice=function(){egret.DeviceOrientation&&(this._orientation=new egret.DeviceOrientation,this._orientation.addEventListener(egret.OrientationEvent.CHANGE,this.onOrientation,this),this._orientation.start())},n.prototype.onOrientation=function(t){this._alpha=t.alpha,this._beta=t.beta,this._gamma=t.gamma,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDeviceOrientationChanged))},n.prototype.onGetGeolocation=function(){egret.Geolocation&&(this._gps=new egret.Geolocation,this._gps.addEventListener(egret.GeolocationEvent.CHANGE,this.onGeolocation,this),this._gps.addEventListener(egret.GeolocationEvent.PERMISSION_DENIED,this.onGeolocation,this),this._gps.addEventListener(egret.GeolocationEvent.UNAVAILABLE,this.onGeolocation,this),this._gps.start())},n.prototype.onGeolocation=function(t){switch(t.type){case egret.GeolocationEvent.CHANGE:this._latitude=t.latitude,this._longitude=t.longitude,this._altitude=t.altitude,this._speed=t.speed,this._heading=t.heading,this._accuracy=t.accuracy,this._altitudeAccuracy=t.altitudeAccuracy,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDevicePostionChanged));
break;case egret.GeolocationEvent.PERMISSION_DENIED:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGeolocationPermissionDenied));break;default:this._geolocationErrorMessage=t.errorMessage,this._geolocationErrorType=t.errorType,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGeolocationFail))}},n.prototype.onDeviceMotion=function(){window.DeviceMotionEvent&&window.addEventListener("devicemotion",this.ondeviceMotionHandler,!1)},n.prototype.ondeviceMotionHandler=function(t){var r=n.instance;r._curTime=egret.getTimer();var a=r._curTime-r._lastUpdate;if(a>100){var i=t.accelerationIncludingGravity;r._lastUpdate=r._curTime,r._x=i.x,r._y=i.y,r._z=i.z;var s=Math.abs(r._x+r._y+r._z-r._lastX-r._lastY-r._lastZ)/a*1e4;s>r.SHAKE_THRESHOLD&&r._curTime-r._lastTime>1100&&r.isShakeble&&(r._lastTime=r._curTime,r.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,r.onDeviceShake))),r._lastX=r._x,r._lastY=r._y,r._lastZ=r._z}},Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.sendSceneInitComplete=function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onSceneInitComplete))},n.prototype.runOs=function(t){var n=e.eval_e(t.os);return{instances:[this],status:n==egret.Capabilities.os}},n.prototype.isMobile=function(t){return{instances:[this],status:e.eval_e(t.mobile)==egret.Capabilities.isMobile}},n.prototype.onRunTimeType=function(t){return{instances:[this],status:e.eval_e(t.runtimeType)==egret.Capabilities.runtimeType}},n.prototype.runLanguageType=function(t){return{instances:[this],status:e.eval_e(t.language)==egret.Capabilities.language}},n.prototype.onGeolocationPermissionDenied=function(e){return{instances:[this],status:!0}},n.prototype.onGeolocationFail=function(e){return{instances:[this],status:!0}},n.prototype.onDeviceShake=function(e){return{instances:[this],status:!0}},n.prototype.onDevicePostionChanged=function(e){return{instances:[this],status:!0}},n.prototype.onDeviceOrientationChanged=function(e){return{instances:[this],status:!0}},n.prototype.onGameDataLoadComplete=function(e){return{instances:[this],status:e.getStatus("key")}},n.prototype.onGameDataSaveComplete=function(e){return{instances:[this],status:e.getStatus("key")}},n.prototype.everyTick=function(e){return{instances:[this],status:!0}},n.prototype.everyXSecondEvent=function(t){return t.curTime=egret.getTimer(),t.curTime-t.oldTime>=1e3*e.eval_e(t.interval)?(t.oldTime=t.curTime,{instances:[this],status:!0}):{instances:[this],status:!1}},n.prototype.onSceneInitComplete=function(e){return{instances:[this],status:!0}},n.prototype.onSceneEndComplete=function(e){return{instances:[this],status:!0}},n.prototype.isValueType=function(e){return{instances:[this],status:!0}},n.prototype.objectUIDExist=function(t){return{instances:[this],status:null!=e.LayoutDecoder.curSceneInstances[e.eval_e(t.UID)]}},n.prototype.testRegex=function(t){var n=e.eval_e(t.str);n+="";var r=t.regex,a=t.flags;return this.cacheRegex&&r==this.lastRegex&&a==this.lastFlags||(this.cacheRegex=new RegExp(r,a),this.lastRegex=r,this.lastFlags=a),this.cacheRegex.lastIndex=0,{instances:[this],status:this.cacheRegex.test(n)}},n.prototype.pickRandomInstance=function(t){var n=e.World.getInstance().objectHash[t.object.name],r=n[Math.floor(Math.random()*n.length)];return{instances:[r],status:n&&n.length>0,selectSingle:!0}},n.prototype.pickAll=function(t){var n=e.World.getInstance().objectHash[t.object.name];return{instances:n,status:!0}},n.prototype.pickInstanceByCondition=function(t){var n=[],r=e.World.getInstance().objectHash[t.object.name];if(r)for(var a=0;a<r.length;a++){var i=r[a];window[i.name]=i,e.EventSheetDecoder.decodeConditionProperties(t);var s=e.compare(t.expression,t.operationType,t.value);s&&n.push(i)}return n.length>0?{instances:n,status:!0}:{instances:[this],status:!1}},n.prototype.pickInstanceByIndex=function(t){var n=e.World.getInstance().objectHash[t.object.name];if(n){var r=e.eval_e(t.index);if(r<n.length-1&&r>=0)return{instances:[n[r]],status:!0}}return{instances:[this],status:!1}},n.prototype.pickInstanceOverlapping=function(t){var n=e.World.getInstance().objectHash[t.object.name];if(n){for(var r=[],a=e.eval_e(t.x),i=e.eval_e(t.y),s=0;s<n.length;s++){var o=n[s],l=o.getGlobalBounds();l.contains(a,i)&&r.push(o)}if(r.length>0)return{instances:r,status:!0}}return{instances:[this],status:!1}},n.prototype.pickInstanceEvaluate=function(e){return{instances:[this],status:!1}},n.prototype.pickInstanceByGUID=function(t){var n=e.LayoutDecoder.curSceneInstances[t.guid];return{instances:[n],status:null!=n}},n.prototype.execFor=function(e){return{instances:[this],status:!0,data:e}},n.prototype.execForEachSort=function(e){return{instances:[this],status:!0,data:e}},n.prototype.compareVariable=function(t){return{instances:[this],status:e.compare(n.instance[t.variable],t.operationType,t.value)}},n.prototype.onLayerIsExist=function(t){return{instances:[this],status:null!=e.LayerManager.getLayer(e.eval_e(t.layer))}},n.prototype.onLayerIsVisible=function(t){var n=e.LayerManager.getLayer(e.eval_e(t.layer));return n?{instances:[this],status:n.visible==e.eval_e(1==t.isVisible)}:{instances:[this],status:!1}},n.prototype.createObject=function(t,n,r,a){var i=e.eval_e(n),s=e.eval_e(r),o=e.eval_e(a);e.assert("number"!=typeof i||"number"!=typeof s||"number"!=typeof o,"AISystem createObject parameter type incorrect!!");var l=t.clone();return l.layer=i,l.x=Math.round(s),l.y=Math.round(o),l.initialize(),l.onCreate(),t.cloneBehavior(l),e.lakeshoreInst()[l.name]=l,e.World.getInstance().addChild(l),[l]},n.prototype.gotoScene=function(t){egret.callLater(function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onSceneEndComplete)),e.World.getInstance().destory(),t=t,e.StartUp.onConfigLoad(t)},this)},n.prototype.disableEvents=function(t,n){var r,a=e.eval_e(t),i=n+"";if(0!=i.length){r=1==i.length?[i]:i.split(",");for(var s=0;s<r.length;s++){var o=+r[s];1==a?delete this.disableDataEvents[o]:this.disableDataEvents[o]=o}}},n.prototype.showLoadingLogo=function(t){var t=e.eval_e(t);e.GameUILayer.stage.addChild(e.GameUILayer.preContainer),e.GameUILayer.preContainer.alpha=1;var n=egret.Tween.get(e.GameUILayer.preContainer);n.wait(1e3*t-250),n.to({alpha:0},250),setTimeout(function(){e.GameUILayer.stage.removeChild(e.GameUILayer.preContainer)},1e3*t)},n.prototype.onScenePauseOrPlay=function(t){var t=e.eval_e(t);e.EventSheetDecoder.execScenePauseOrPlay(t)},n.prototype.log=function(t){e.log(t)},n.prototype.addTo=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject addTo parameter type incorrect!!"),this[t]+=r,this.globalVariables[t]=this[t]},n.prototype.setBoolean=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject setBoolean parameter type incorrect!!"),this[t]=1==r,this.globalVariables[t]=this[t]},n.prototype.setValue=function(t,n){var r=e.eval_e(n);this[t]=r,this.globalVariables[t]=this[t]},n.prototype.subtractFrom=function(t,n){var r=e.eval_e(n);e.assert("number"!=typeof r,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=r,this.globalVariables[t]=this[t]},n.prototype.toogleBoolean=function(e){this[e]=!this[e],this.globalVariables[e]=this[e]},n.prototype.stopLoop=function(){},n.prototype.load=function(e){},n.prototype.restartScene=function(){e.assert(null==e.LayoutDecoder.currentLayoutName,"current layout name is null!"),this.gotoScene(e.LayoutDecoder.currentLayoutName)},n.prototype.resetGlobalVariables=function(){},n.prototype.scrollToObject=function(t){var n=t.getFirstPicked();n&&e.World.getInstance().sceneCamera.lookAtChar(n)},n.prototype.scrollToPos=function(t,n){var r=e.eval_e(t),a=e.eval_e(n);e.World.getInstance().sceneCamera.lookAtPoint(new egret.Point(r,a))},n.prototype.scrollToXPos=function(t){var n=e.eval_e(t);e.World.getInstance().sceneCamera.lookAtX(n)},n.prototype.scrollToYPos=function(t){var n=e.eval_e(t);e.World.getInstance().sceneCamera.lookAtY(n)},n.prototype.setLayerAngle=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),r=e.LayerManager.getLayer(t);r&&r.rotation!=n&&(r.rotation=n)},n.prototype.setLayerBgColor=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),r=e.LayerManager.getLayer(t);r&&(r.bgColor=n,r.graphics.clear(),r.graphics.beginFill(n),r.graphics.drawRect(0,0,r.scaleX*e.LayoutDecoder.sceneWidth,r.scaleY*e.LayoutDecoder.sceneHeight),r.graphics.endFill())},n.prototype.setLayerBgColorAlpha=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),r=e.LayerManager.getLayer(t);r&&(r.graphics.clear(),r.graphics.beginFill(r.bgColor,n),r.graphics.drawRect(0,0,r.scaleX*e.LayoutDecoder.sceneWidth,r.scaleY*e.LayoutDecoder.sceneHeight),r.graphics.endFill())},n.prototype.setLayerAlpha=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),r=e.LayerManager.getLayer(t);r&&(r.alpha=n)},n.prototype.setLayerParallax=function(t,n,r){for(var t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.World.getInstance().objectList,i=0,s=a.length;s>i;i++){var o=a[i];o.index==t&&(o.parallaxX=n,o.parallaxY=r)}var l=e.LayerManager.getLayer(t);l&&(l.parallaxX=n,l.parallaxY=r)},n.prototype.setLayerScale=function(t,n,r){var t=e.eval_e(t),n=e.eval_e(n),r=e.eval_e(r),a=e.LayerManager.getLayer(t);a&&(a.scaleX!=n||a.scaleY!=r)&&(a.scaleX=n,a.scaleY=r)},n.prototype.setLayerVisible=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),r=e.LayerManager.getLayer(t);r&&(r.visible=1==n)},n.prototype.setObjectTimeScale=function(t,n){if(t){n=e.eval_e(n),0>n&&(n=0);for(var r=e.World.getInstance().objectHash[t.name],a=0;a<r.length;a++)r[a].timeScale=n}},n.prototype.setTimeScale=function(t){e.EventSheetDecoder.timeScale=e.eval_e(t),e.EventSheetDecoder.timeScale<0&&(e.EventSheetDecoder.timeScale=0)},n.prototype.startDeviceOrientation=function(t){var n=e.eval_e(t);this._orientation&&(0==n?this._orientation.stop():this._orientation.start())},n.prototype.startDeviceGeolocation=function(t){var n=e.eval_e(t);this._gps&&(0==n?this._gps.stop():this._gps.start())},n.prototype.onLoadComplete=function(){},n.prototype.loadStorageFromJSON=function(t){if("undefined"==typeof localStorage)return void e.assert(!0,"当前浏览器不支持本地存储");var t=e.eval_e(t);this.loadStorages[t]=!1;var n=localStorage.getItem(t);if(void 0!=n&&null!=n){var r=JSON.parse(n),a=e.World.getInstance().objectList;for(var i in r){for(var s=r[i],o=null,l=0;l<a.length;l++){var c=a[l];if(c.u_id==parseFloat(i)){o=c;break}}if(o)o.loadFromJSON(s);else if(s.plugin){var h=s.plugin.slice(3),u=e.getInstanceByPluginClassName(h);u.loadFromJSON(s),u.initialize(),u.onCreate(),e.World.getInstance().addChild(u),e.registerObject(u.name,u);for(var l=0;l<e.EventSheetDecoder.curSceneEvents.length;l++)for(var p=e.EventSheetDecoder.curSceneEvents[l],f=0;f<p.conditionBlocks.length;f++)for(var v=p.conditionBlocks[f],_=0;_<v.conditions.length;_++){var y=v.conditions[_];y.callTarget instanceof e.AIObject&&y.callTarget.u_id==u.u_id&&(y.callTarget=u,v.cs&&v.cs.instanceStatus&&v.cs.instanceStatus[u.u_id]&&(v.cs.instanceStatus[u.u_id].instance=u))}}}for(var d=[],l=0;l<a.length;l++){var c=a[l];void 0==r[c.u_id]&&d.push(c)}for(var l=0;l<d.length;l++)e.World.getInstance().removeChild(d[l]),d[l].destory();d=[];var g=r.globalVariables;for(var m in g)this[m]=g[m];console.log("加载存档完毕！！"),this.loadStorages[t]=!0,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGameDataLoadComplete,{key:t}))}},n.prototype.saveStorageToJSON=function(t){if("undefined"==typeof localStorage)return void e.assert(!0,"当前浏览器不支持本地存储");var t=e.eval_e(t);this.saveStorages[t]=!1;var n={},r=e.World.getInstance().objectList;if(r)for(var a=0;a<r.length;a++){var i=r[a];n[i.u_id]=i.saveToJSON()}n.globalVariables=this.globalVariables;var s=JSON.stringify(n);localStorage.setItem(t,s),console.log("保存存档完毕！！"),console.log(s),this.saveStorages[t]=!0,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGameDataSaveComplete,{key:t}))},n.prototype.destory=function(){},Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"beta",{get:function(){return this._beta},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gamma",{get:function(){return this._gamma},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"latitude",{get:function(){return this._latitude},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"longitude",{get:function(){return this._longitude},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"altitude",{get:function(){return this._altitude},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"speed",{get:function(){return this._speed},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"heading",{get:function(){return this._heading},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"accuracy",{get:function(){return this._accuracy},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"altitudeAccuracy",{get:function(){return this._altitudeAccuracy},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"geolocationErrorMessage",{get:function(){return this._geolocationErrorMessage},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"geolocationErrorType",{get:function(){return this._geolocationErrorType},enumerable:!0,configurable:!0}),n.prototype.layerX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.x},n.prototype.layerY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.y},n.prototype.layerAngle=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.rotation},n.prototype.layerAlpha=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.alpha},n.prototype.layerVisible=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.visible},n.prototype.layerAnchorOffsetX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.anchorOffsetX},n.prototype.layerAnchorOffsetY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.anchorOffsetY},n.prototype.layerWidth=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.width},n.prototype.layerHeight=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.height},n.prototype.layerScaleX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.scaleX},n.prototype.layerScaleY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.scaleY},n.prototype.layerParallaxX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.parallaxX},n.prototype.layerParallaxY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.parallaxY},n}(e.AIObject);e.AISystem=t,__reflect(t.prototype,"ls.AISystem");var n=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.RunOsEvent=n,__reflect(n.prototype,"ls.RunOsEvent");var r=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.IsMobileEvent=r,__reflect(r.prototype,"ls.IsMobileEvent");var a=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.RuntimeTypeEvent=a,__reflect(a.prototype,"ls.RuntimeTypeEvent");var i=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.RunLanguageEvent=i,__reflect(i.prototype,"ls.RunLanguageEvent");var s=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnGeolocationPermissionDeniedEvent=s,__reflect(s.prototype,"ls.OnGeolocationPermissionDeniedEvent");var o=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnGeolocationFailEvent=o,__reflect(o.prototype,"ls.OnGeolocationFailEvent");var l=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnDeviceShakeEvent=l,__reflect(l.prototype,"ls.OnDeviceShakeEvent");var c=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnDevicePositionChangedEvent=c,__reflect(c.prototype,"ls.OnDevicePositionChangedEvent");var h=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.onDeviceOrientationChangedEvent=h,__reflect(h.prototype,"ls.onDeviceOrientationChangedEvent");var u=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.EveryTickEvent=u,__reflect(u.prototype,"ls.EveryTickEvent");var p=function(e){function t(){var t=e.call(this)||this;return t.interval=0,t.oldTime=0,t.curTime=0,t}return __extends(t,e),t}(e.BaseEvent);e.EveryXSecondsEvent=p,__reflect(p.prototype,"ls.EveryXSecondsEvent");var f=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.TestRegexEvent=f,__reflect(f.prototype,"ls.TestRegexEvent");var v=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.OnSceneInitCompleteEvent=v,__reflect(v.prototype,"ls.OnSceneInitCompleteEvent");var _=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.OnSceneEndCompleteEvent=_,__reflect(_.prototype,"ls.OnSceneEndCompleteEvent");var y=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.IsValueTypeEvent=y,__reflect(y.prototype,"ls.IsValueTypeEvent");var d=function(e){function t(){var t=e.call(this)||this;return t.UID=0,t}return __extends(t,e),t}(e.BaseEvent);e.ObjectUIDExistEvent=d,__reflect(d.prototype,"ls.ObjectUIDExistEvent");var g=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.PickRandomInstanceEvent=g,__reflect(g.prototype,"ls.PickRandomInstanceEvent");var m=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.PickAllEvent=m,__reflect(m.prototype,"ls.PickAllEvent");var b=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.PickByComparisionEvent=b,__reflect(b.prototype,"ls.PickByComparisionEvent");var x=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.PickInstanceByIndexEvent=x,__reflect(x.prototype,"ls.PickInstanceByIndexEvent");var E=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.PickInstanecOverlappingEvent=E,__reflect(E.prototype,"ls.PickInstanecOverlappingEvent");var C=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.PickInstanceEvaluateEvent=C,__reflect(C.prototype,"ls.PickInstanceEvaluateEvent");var I=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.PickInstanceByGUIDEvent=I,__reflect(I.prototype,"ls.PickInstanceByGUIDEvent");var O=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseEvent);e.CompareVariableEvent=O,__reflect(O.prototype,"ls.CompareVariableEvent");var S=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.ForEachOrderEvent=S,__reflect(S.prototype,"ls.ForEachOrderEvent");var T=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.ForEvent=T,__reflect(T.prototype,"ls.ForEvent");var w=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnGameDataLoadCompleteEvent=w,__reflect(w.prototype,"ls.OnGameDataLoadCompleteEvent");var D=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnGameDataSaveCompleteEvent=D,__reflect(D.prototype,"ls.OnGameDataSaveCompleteEvent");var L=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnLayerIsExistEvent=L,__reflect(L.prototype,"ls.OnLayerIsExistEvent");var A=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t}(e.BaseEvent);e.OnLayerIsVisibleEvent=A,__reflect(A.prototype,"ls.OnLayerIsVisibleEvent")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return t.register=function(t){t.addEventListener(e.TriggerEvent.TRIGGER,this.onTrigger,this)},t.removeTrigger=function(t){t.removeEventListener(e.TriggerEvent.TRIGGER,this.onTrigger,this)},t.removeAllTriggers=function(){for(var t=0,n=e.World.getInstance().objectList.length;n>t;t++)this.removeTrigger(e.World.getInstance().objectList[t])},t.setConditionStatus=function(t,n,r,a){void 0===r&&(r=null),void 0===a&&(a=null),void 0==t.triggerfilters&&(t.triggerfilters={}),t.triggerfilters[n.u_id]=n,t.triggerStatus=!0,t.triggerData=r,t.triggerChangeValue=a,e.EventSheetDecoder.run||e.EventSheetDecoder.execScenePauseOrPlay(1)},t.onTrigger=function(t){for(var n=(e.AISystem.instance.disableDataEvents,e.EventSheetDecoder.triggerConditions),r=t.currentTarget,a=r instanceof e.BaseBehavior,i=t.triggerData,s=0,o=n.length;o>s;s++){var l=n[s];if(l.event.enabled){if(l.callCondition!=t.triggerCondition)continue;if(l.isFamily)if(a){var c=e.EventSheetDecoder.curFamilys[l.targetName].insts;if(c)for(var h=0,u=c.length;u>h;h++)for(var p=c[h],f=p.name,v=e.World.getInstance().objectHash[f],_=0,y=v.length;y>_;_++){var d=v[_];this.getCollsionStatus(l,i)&&this.compareParam(l,i)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,i.object,i,t.changeValue),this.setConditionStatus(l,d,i,t.changeValue))}}else{var g=null,c=e.EventSheetDecoder.curFamilys[l.targetName].insts;if(c){for(var h=0,u=c.length;u>h;h++)for(var p=c[h],f=p.name,v=e.World.getInstance().objectHash[f],_=0,y=v.length;y>_;_++){var d=v[_];if(d.u_id==r.u_id){g=d;break}}this.getCollsionStatus(l,i)&&this.compareParam(l,i)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,i.object,i,t.changeValue),g&&this.setConditionStatus(l,g,i,t.changeValue))}else e.assert(!0,"组触发条件目标查找失败,组名："+l.targetName)}else if(a)l.callTarget.name==r.name&&l.targetName==r.inst.name&&this.getCollsionStatus(l,i)&&this.compareParam(l,i)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,i.object,i,t.changeValue),this.setConditionStatus(l,r.inst,i,t.changeValue));else{var g=null;l.targetName==r.name&&(g=r),g&&this.getCollsionStatus(l,i)&&this.compareParam(l,i)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,i.object,i,t.changeValue),this.setConditionStatus(l,g,i,t.changeValue))}}}},t.compareParam=function(t,n){var r=!1;if(n)for(var a=t.paramsInstance.data,i=0,s=a.children.length;s>i;i++){var o=e.eval_e(decodeURIComponent(a.children[i].attributes.value));for(var l in n){var c=n[l];if(c instanceof e.AIObject&&o instanceof e.AIObject){if(c.name==o.name){r=!0;break}}else if(c==o){r=!0;break}}if(r)break}else r=!0;return r},t.getCollsionStatus=function(t,n){if("onCollisionWithOtherObject"===t.callConditionName&&n){var r=t.paramsInstance,a=r.data,i=a.children,s=!1;if(i&&i.length>0)for(var o=0;o<i.length;o++){var l=i[o];if(n.object.name===e.eval_e(decodeURIComponent(l.attributes.value)).name){s=!0;break}}if(!s)return!1}return!0},t}();e.Trigger=t,__reflect(t.prototype,"ls.Trigger")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"nativeBase64",{get:function(){return"function"==typeof window.atob},enumerable:!0,configurable:!0}),t.decode=function(e){if(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),this.nativeBase64&&window.atob)return window.atob(e);for(var t,n,r,a,i,s,o,l=[],c=0;c<e.length;)a=this._keyStr.indexOf(e.charAt(c++)),i=this._keyStr.indexOf(e.charAt(c++)),s=this._keyStr.indexOf(e.charAt(c++)),o=this._keyStr.indexOf(e.charAt(c++)),t=a<<2|i>>4,n=(15&i)<<4|s>>2,r=(3&s)<<6|o,l.push(String.fromCharCode(t)),64!==s&&l.push(String.fromCharCode(n)),64!==o&&l.push(String.fromCharCode(r));return l=l.join("")},t.encode=function(e){if(e=e.replace(/\r\n/g,"\n"),!this.nativeBase64||!window.btoa){for(var t,n,r,a,i,s,o,l=[],c=0;c<e.length;)t=e.charCodeAt(c++),n=e.charCodeAt(c++),r=e.charCodeAt(c++),a=t>>2,i=(3&t)<<4|n>>4,s=(15&n)<<2|r>>6,o=63&r,isNaN(n)?s=o=64:isNaN(r)&&(o=64),l.push(this._keyStr.charAt(a)),l.push(this._keyStr.charAt(i)),l.push(this._keyStr.charAt(s)),l.push(this._keyStr.charAt(o));return l=l.join("")}window.btoa(e)},t.decodeBase64AsArray=function(e,n){n=n||1;var r,a,i,s=t.decode(e),o=new Uint32Array(s.length/n);for(r=0,i=s.length/n;i>r;r++)for(o[r]=0,a=n-1;a>=0;--a)o[r]+=s.charCodeAt(r*n+a)<<(a<<3);return o},t.decompress=function(t,n,r){e.assert(!0,"GZIP/ZLIB compressed TMX Tile Map not supported!")},t.decodeCSV=function(e){for(var t=e.replace("\n","").trim().split(","),n=[],r=0;r<t.length;r++)n.push(+t[r]);return n},t}();t._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e.Base64=t,__reflect(t.prototype,"ls.Base64")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function t(){}return t.isCollision=function(e,t,n,r,a,i){return e>=n&&n+a>=e&&t>=r&&r+i>=t},t.isCollsionWithRect=function(e,t,n,r,a,i,s,o){return e>=a&&e>=a+s?!1:a>=e&&a>=e+n?!1:t>=i&&t>=i+o?!1:i>=t&&i>=t+r?!1:!0},t.isCollisionPointWithCircle=function(e,t,n,r,a){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))<=a},t.isCollisionCircleWithCircle=function(e,t,n,r,a,i){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))<=a+i},t.isCollisionRectWithCircle=function(e,t,n,r,a,i,s){var o=.5*n,l=.5*r,c=a-(e+o),h=i-(t+l),u=Math.min(c,o),p=Math.max(u,-o),f=Math.min(h,l),v=Math.max(f,-l);return s*s>=(p-c)*(p-c)+(v-h)*(v-h)},t.checkPointCollideShape=function(e,t,n){var r=n.length;if(3>r)return!1;var a=0,i=[];for(a=0;a<n.length;a++){var s=new egret.Point(n[a].x,n[a].y);i.push(s)}for(a=0;a<i.length;a++)i[a].x+=t.x,i[a].y+=t.y;if(this.vectorCrossPoint(i[0],e,i[1])>0)return!1;if(this.vectorCrossPoint(i[0],e,i[r-1])<0)return!1;a=2;for(var o=r-1,l=-1;o>=a;){var c=a+o>>1;this.vectorCrossPoint(i[0],e,i[c])>0?(l=c,o=c-1):a=c+1}return 0>l?!1:this.vectorCrossPoint(i[l-1],e,i[l])<0},t.vectorCrossPoint=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)},t.hitTest=function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++){var a=e[n],i=t[r];if(this.simpleLineTest(a,i))return!0}return!1},t.simpleLineTest=function(e,t){var n=e.p1x,r=e.p1y,a=e.p2x,i=e.p2y,s=t.p1x,o=t.p1y,l=t.p2x,c=t.p2y,h=(a-n)*(o-r)-(s-n)*(i-r),u=(a-n)*(c-r)-(l-n)*(i-r),p=(l-s)*(r-o)-(n-s)*(c-o),f=(l-s)*(i-o)-(a-s)*(c-o);return 0>=h*u&&0>=p*f},t.intersects_rect=function(e,t){return!(t.right<e.left||t.bottom<e.top||t.left>e.right||t.top>e.bottom)},t.segments_intersect=function(e,t,n,r,a,i,s,o){var l,c,h,u,p,f,v,_;if(n>e?(c=e,l=n):(c=n,l=e),s>a?(f=a,p=s):(f=s,p=a),f>l||c>p)return!1;if(r>t?(u=t,h=r):(u=r,h=t),o>i?(_=i,v=o):(_=o,v=i),_>h||u>v)return!1;var y=a-e+s-n,d=i-t+o-r,g=n-e,m=r-t,b=s-a,x=o-i,E=Math.abs(m*b-x*g),C=b*d-x*y;if(Math.abs(C)>E)return!1;var I=g*d-m*y;return Math.abs(I)<=E},t.testOverlap=function(t,n){if(!t||!n||t===n)return!1;var r=!1;return t.pushoutSolid&&(r=!0,!n.customSolidEnabled)?!1:n.pushoutSolid&&(r=!0,!t.customSolidEnabled)?!1:(t.jumpthruEnabled||t.platformEnabled||t.collision||t.solidEnabeld)&&(n.jumpthruEnabled||n.platformEnabled||n.collision||n.solidEnabeld)?e.Collision.checkCollision(t,n):!1},t.getLines=function(t){var n=e.MathUtils.toRadian(t.angle),r=new egret.Matrix;r.translate(-t.width/2,-t.height/2),r.rotate(n);var a=new egret.Matrix;a.translate(t.width/2,-t.height/2),a.rotate(n);var i=new egret.Matrix;i.translate(t.width/2,t.height/2),i.rotate(n);var s=new egret.Matrix;s.translate(-t.width/2,t.height/2),s.rotate(n);var o=[],l={p1x:r.tx+t.x,p1y:r.ty+t.y,p2x:a.tx+t.x,p2y:a.tx+t.y},c={p1x:a.tx+t.x,p1y:a.ty+t.y,p2x:i.tx+t.x,p2y:i.ty+t.y},h={p1x:i.tx+t.x,p1y:i.ty+t.y,p2x:s.tx+t.x,p2y:s.ty+t.y},u={p1x:s.tx+t.x,p1y:s.ty+t.y,p2x:r.tx+t.x,p2y:r.ty+t.y};return o.push(l,c,h,u),o},t.getSolidCollisionCandidates=function(e,t,n){},t.testOverlapSolid=function(t){for(var n=e.World.getInstance().objectList,r=0;r<n.length;r++){var a=n[r];if(a!=t){var i=!1;if(a.solidEnabeld&&(i=!0),t.pushoutSolid&&void 0!==a.customSolidEnabled&&a.customSolidEnabled&&(i=!0),i&&this.testOverlap(t,a))return a}}return null},t.testOverlapJumpThru=function(t,n){void 0===n&&(n=!1);var r=e.World.getInstance().objectList,a=null;n&&(a=[]);for(var i=0,s=r.length;s>i;i++){var o=r[i];if(o.jumpthruEnabled&&this.testOverlap(t,o)){if(!n)return[o];a.push(o)}}return a},t.pushInFractional=function(e,t,n,r,a){for(var i,s=2,o=!1,l=!1,c=e.x,h=e.y;a>=s;)i=1/s,s*=2,e.x+=t*i*(o?1:-1),e.y+=n*i*(o?1:-1),this.testOverlap(e,r)?(o=!0,l=!0):(o=!1,l=!1,c=e.x,h=e.y);l&&(e.x=c,e.y=h)},t.pushOutSolid=function(e,t,n,r,a,i){void 0===r&&(r=0),void 0===a&&(a=!1),void 0===i&&(i=null);for(var s=r||50,o=e.x,l=e.y,c=null,h=null,u=0;s>u;u++){e.x=o+t*u,e.y=l+n*u;var p=this.testOverlap(e,c);if(!p)if(c=this.testOverlapSolid(e))h=c;else if(a&&(c=i?this.testOverlap(e,i)?i:null:this.testOverlapJumpThru(e),c&&(h=c)),!c)return h&&this.pushInFractional(e,t,n,h,16),!0}return e.x=o,e.y=l,!1},t.pushOutSolidNearest=function(t,n){void 0===n&&(n=100);var r=e.is_undefined(r)?100:r,a=0,i=t.x,s=t.y,o=0,l=0,c=0,h=this.testOverlapSolid(t);if(!h)return!0;for(;r>=a;){switch(o){case 0:l=0,c=-1,a++;break;case 1:l=1,c=-1;break;case 2:l=1,c=0;break;case 3:l=1,c=1;break;case 4:l=0,c=1;break;case 5:l=-1,c=1;break;case 6:l=-1,c=0;break;case 7:l=-1,c=-1}if(o=(o+1)%8,t.x=Math.floor(i+l*a),t.y=Math.floor(s+c*a),!this.testOverlap(t,h)&&(h=this.testOverlapSolid(t),!h))return!0}return t.x=i,t.y=s,!1},t.calculateSolidBounceAngle=function(t,n,r,a){void 0===a&&(a=null);var i=t.x,s=t.y,o=Math.max(10,e.distance(n,r,i,s)),l=e.MathUtils.radianTo(n,r,i,s),c=a||this.testOverlapSolid(t);if(!c)return e.MathUtils.clampRadian(l+Math.PI);var h,u,p,f,v=c,_=e.MathUtils.toRadian(5);for(h=1;36>h;h++)if(u=l-h*_,t.x=n+Math.cos(u)*o,t.y=r+Math.sin(u)*o,!this.testOverlap(t,v)&&(v=a?null:this.testOverlapSolid(t),!v)){p=u;break}36===h&&(p=e.MathUtils.clampRadian(l+Math.PI));var v=c;for(h=1;36>h;h++)if(u=l+h*_,t.x=n+Math.cos(u)*o,t.y=r+Math.sin(u)*o,!this.testOverlap(t,v)&&(v=a?null:this.testOverlapSolid(t),!v)){f=u;break}if(36===h&&(f=e.MathUtils.clampRadian(l+Math.PI)),t.x=i,t.y=s,f===p)return f;var y,d=e.MathUtils.angleDiff(f,p)/2;y=e.MathUtils.angleClockWise(f,p)?e.MathUtils.clampRadian(p+d+Math.PI):e.MathUtils.clampRadian(f+d);var g=Math.cos(l),m=Math.sin(l),b=Math.cos(y),x=Math.sin(y),E=g*b+m*x,C=g-2*E*b,I=m-2*E*x;return e.MathUtils.radianTo(0,0,C,I)},t}();e.CollisionUtils=t,__reflect(t.prototype,"ls.CollisionUtils")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(){}return e.toRadian=function(e){return e*this.TO_RADIAN},e.toAngle=function(e){return e*this.TO_ANGLE},e.clampAngle=function(e){return e%=360,0>e&&(e+=360),e},e.clampRadian=function(e){return e%=2*Math.PI,0>e&&(e+=2*Math.PI),e},e.angleRotate=function(t,n,r){var a=this.toRadian(t),i=this.toRadian(n);return e.toAngle(this.angleRadius(a,i,r))},e.angleRadius=function(e,t,n){var r=Math.sin(e),a=Math.cos(e),i=Math.sin(t),s=Math.cos(t);return Math.acos(r*i+a*s)>n?a*i-r*s>0?this.clampRadian(e+n):this.clampRadian(e-n):this.clampRadian(t)},e.angleClockWise=function(e,t){var n=Math.sin(e),r=Math.cos(e),a=Math.sin(t),i=Math.cos(t);return 0>=r*a-n*i},e.angleTo=function(e,t,n,r){return this.toAngle(Math.atan2(r-t,n-e))},e.radianTo=function(e,t,n,r){return Math.atan2(r-t,n-e)},e.distance=function(e,t,n,r){var a=n-e,i=r-t;return Math.sqrt(a*a+i*i)},e.color16ToUnit=function(e){var t="0x"+e.slice(1);return parseInt(t,16)},e.angleDiff=function(e,t){if(e===t)return 0;
var n=Math.sin(e),r=Math.cos(e),a=Math.sin(t),i=Math.cos(t),s=n*a+r*i;return s>=1?0:-1>=s?Math.PI:Math.acos(s)},e}();t.TO_RADIAN=Math.PI/180,t.TO_ANGLE=180/Math.PI,e.MathUtils=t,__reflect(t.prototype,"ls.MathUtils")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ls;!function(e){var t=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return Math.sqrt(this._x*this._x+this._y*this._y)},set:function(e){var t=this.angle;this._x=Math.cos(t)*e,this._y=Math.sin(t)*e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lengthSQ",{get:function(){return this._x*this._x+this._y*this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return Math.atan2(this._y,this._x)},set:function(e){var t=this.length;this._x=Math.cos(e)*t,this._y=Math.sin(e)*t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{set:function(e){var t=e/180*Math.PI;this.angle=t},enumerable:!0,configurable:!0}),e.prototype.normalize=function(){var e=this.length;return e?(this.x/=e,this.y/=e,this):this},e.prototype.truncate=function(e){return this.length=Math.min(e,this.length),this},e.prototype.reverse=function(){return this._x=-this._x,this._y=-this._y,this},e.prototype.isNormalized=function(){return 1==this.length},e.prototype.dotProd=function(e){return this._x*e._x+this._y*e._y},e.prototype.crossProd=function(e){return 0===this.getCross(e)},e.prototype.getCross=function(e){return this._x*e._y-this._y*e._x},e.angleBetween=function(e,t){return e.isNormalized()||(e=e.clone().normalize()),t.normalize()||(t=t.clone().normalize()),Math.acos(e.dotProd(t))},Object.defineProperty(e.prototype,"perp",{get:function(){return new e(-this._y,this._x)},enumerable:!0,configurable:!0}),e.prototype.sign=function(e){return this.perp.dotProd(e)<0?-1:1},e.prototype.distance=function(e){return Math.sqrt(this.distanceSQ(e))},e.prototype.distanceSQ=function(e){var t=e._x-this._x,n=e._y-this._y;return t*t+n*n},e.prototype.equals=function(e){return this._x===e._x&&this._y===e._y},e.prototype.isZero=function(){return 0===this._x&&0===this._y},e.prototype.scale=function(e){return this._x*=e,this._y*=e,this},e.prototype.add=function(e,t){return this._x+=e,this._y+=t,this},e.prototype.substruct=function(e,t){return this._x-=e,this._y-=t,this},e.prototype.multiply=function(e,t){return this._x*=e,this._y*=t,this},e.prototype.divide=function(e,t){return this._x/=e,this._y/=t,this},e.prototype.clone=function(){var t=new e;return t._x=this._x,t._y=this._y,t},e.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},e}();e.Vector2D=t,__reflect(t.prototype,"ls.Vector2D")}(ls||(ls={}));var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},ls;!function(e){var t=function(e){function t(){var t=e.apply(this,arguments)||this;return t.index=0,t.execActionIndex=0,t.computeTargets={},t.enabled=!0,t}return __extends(t,e),t}(e.BaseEvent);e.AIEvent=t,__reflect(t.prototype,"ls.AIEvent")}(ls||(ls={}));